                if (addBudgetBtn) {
                    addBudgetBtn.addEventListener('click', function() {
                        document.getElementById('budget-form').style.display = 'block';
                        this.style.display = 'inline-block';
                    });
                }
                
                if (cancelBudgetBtn) {
                    cancelBudgetBtn.addEventListener('click', function() {
                        document.getElementById('budget-form').style.display = 'none';
                        document.getElementById('add-budget-btn').style.display = 'inline-block';
                    });
                }
                
                if (saveBudgetBtn) {
                    saveBudgetBtn.addEventListener('click', function() {
                        saveBudgetData();
                        if (currentClinic) {
                            updateBudgetCategoryChart();
                        }
                    });
                }
                
                // Export buttons
                const downloadExcelBtn = document.getElementById('download-excel');
                const downloadPowerPointBtn = document.getElementById('download-powerpoint');
                
                if (downloadExcelBtn) {
                    downloadExcelBtn.addEventListener('click', function() {
                        downloadExcelReport();
                    });
                }
                
                if (downloadPowerPointBtn) {
                    downloadPowerPointBtn.addEventListener('click', function() {
                        downloadPowerPointReport();
                    });
                }
            }
            
            // Setup image upload
            function setupImageUpload() {
                const imageUploadArea = document.getElementById('image-upload-area');
                const imageInput = document.getElementById('edit-clinic-image');
                const imagePreview = document.getElementById('edit-clinic-image-preview');
                
                if (imageUploadArea && imageInput) {
                    // Click to upload
                    imageUploadArea.addEventListener('click', function() {
                        imageInput.click();
                    });
                    
                    // File selection
                    imageInput.addEventListener('change', function() {
                        handleImageUpload();
                    });
                }
            }
            
            // Handle image upload
            function handleImageUpload() {
                const imageInput = document.getElementById('edit-clinic-image');
                const imagePreview = document.getElementById('edit-clinic-image-preview');
                
                if (imageInput.files && imageInput.files[0]) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        imagePreview.src = e.target.result;
                        imagePreview.style.display = 'block';
                    };
                    
                    reader.readAsDataURL(imageInput.files[0]);
                }
            }
            
            // Setup chart period selectors
            function setupChartPeriodSelectors() {
                const periodButtons = document.querySelectorAll('.period-btn');
                periodButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        // Remove active class from all buttons
                        periodButtons.forEach(btn => btn.classList.remove('active'));
                        // Add active class to clicked button
                        this.classList.add('active');
                        
                        // Update charts with selected period
                        updateDashboardCharts();
                    });
                });
            }
            
            // Initialize charts
            function initializeCharts() {
                // Initialize budget chart
                const budgetChartCtx = document.getElementById('budget-chart');
                if (budgetChartCtx) {
                    budgetChart = new Chart(budgetChartCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'],
                            datasets: [
                                {
                                    label: 'Total Anggaran',
                                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: 'rgba(30, 58, 138, 0.2)',
                                    borderColor: '#1e3a8a',
                                    borderWidth: 3,
                                    pointBackgroundColor: '#1e3a8a',
                                    pointRadius: 5,
                                    pointHoverRadius: 7,
                                    fill: true,
                                    tension: 0.3
                                },
                                {
                                    label: 'Total Realisasi',
                                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: 'rgba(5, 150, 105, 0.2)',
                                    borderColor: '#059669',
                                    borderWidth: 3,
                                    pointBackgroundColor: '#059669',
                                    pointRadius
                                                    // Add total row
                const totalRow = document.createElement('tr');
                totalRow.style.fontWeight = 'bold';
                totalRow.style.backgroundColor = '#f8fafc';
                totalRow.innerHTML = `
                    <td colspan="2"><strong>TOTAL</strong></td>
                    <td><strong>Rp ${total.toLocaleString('id-ID')}</strong></td>
                    <td></td>
                `;
                tbody.appendChild(totalRow);
            }
            
            // Edit data pendapatan
            function editIncomeData(index) {
                if (!currentClinic) return;
                
                // Find the actual index in the original array
                const yearFilter = document.getElementById('income-year-filter').value;
                const monthFilter = document.getElementById('income-month-filter').value;
                
                let filteredIndex = 0;
                let actualIndex = -1;
                
                for (let i = 0; i < currentClinic.income.length; i++) {
                    const item = currentClinic.income[i];
                    if (item.year.toString() === yearFilter && 
                        (monthFilter === 'all' || item.month.toString() === monthFilter)) {
                        if (filteredIndex === index) {
                            actualIndex = i;
                            break;
                        }
                        filteredIndex++;
                    }
                }
                
                if (actualIndex === -1) return;
                
                const incomeData = currentClinic.income[actualIndex];
                document.getElementById('income-month').value = incomeData.month;
                document.getElementById('income-year').value = incomeData.year;
                document.getElementById('income-amount').value = incomeData.amount;
                
                // Tampilkan form
                document.getElementById('income-form').style.display = 'block';
                document.getElementById('add-income-btn').style.display = 'none';
                
                // Simpan index untuk update
                currentEditIndex = actualIndex;
            }
            
            // Simpan data pendapatan
            function saveIncomeData() {
                if (!currentClinic) return;
                
                const month = parseInt(document.getElementById('income-month').value);
                const year = parseInt(document.getElementById('income-year').value);
                const amount = parseInt(document.getElementById('income-amount').value);
                
                if (isNaN(month) || isNaN(year) || isNaN(amount)) {
                    alert('Mohon isi semua field dengan benar');
                    return;
                }
                
                if (currentEditIndex !== null) {
                    // Update existing data
                    currentClinic.income[currentEditIndex] = { month, year, amount };
                    currentEditIndex = null;
                } else {
                    // Add new data
                    // Cek apakah data untuk bulan dan tahun ini sudah ada
                    const existingIndex = currentClinic.income.findIndex(i => i.month === month && i.year === year);
                    if (existingIndex !== -1) {
                        // Jika sudah ada, update data yang ada
                        currentClinic.income[existingIndex] = { month, year, amount };
                    } else {
                        // Jika belum ada, tambahkan data baru
                        currentClinic.income.push({ month, year, amount });
                    }
                }
                
                // Sembunyikan form dan tampilkan tombol add
                document.getElementById('income-form').style.display = 'none';
                document.getElementById('add-income-btn').style.display = 'inline-block';
                
                // Reset form
                document.getElementById('income-month').value = '1';
                document.getElementById('income-year').value = '2024';
                document.getElementById('income-amount').value = '';
                
                // Refresh table
                loadClinicIncome(currentClinic);
                
                alert('Data pendapatan berhasil disimpan!');
            }
            
            // Hapus data pendapatan
            function deleteIncomeData(index) {
                if (!currentClinic) return;
                
                // Find the actual index in the original array
                const yearFilter = document.getElementById('income-year-filter').value;
                const monthFilter = document.getElementById('income-month-filter').value;
                
                let filteredIndex = 0;
                let actualIndex = -1;
                
                for (let i = 0; i < currentClinic.income.length; i++) {
                    const item = currentClinic.income[i];
                    if (item.year.toString() === yearFilter && 
                        (monthFilter === 'all' || item.month.toString() === monthFilter)) {
                        if (filteredIndex === index) {
                            actualIndex = i;
                            break;
                        }
                        filteredIndex++;
                    }
                }
                
                if (actualIndex === -1) return;
                
                if (confirm('Apakah Anda yakin ingin menghapus data pendapatan ini?')) {
                    currentClinic.income.splice(actualIndex, 1);
                    loadClinicIncome(currentClinic);
                    alert('Data pendapatan berhasil dihapus!');
                }
            }
            
            // Load data realisasi klinik
            function loadClinicRealization(clinic) {
                // Update honor values
                document.getElementById('honor-medis').value = clinic.realization.honor.medis;
                document.getElementById('honor-paramedis').value = clinic.realization.honor.paramedis;
                document.getElementById('honor-pengelola').value = clinic.realization.honor.pengelola;
                
                // Update operational values
                document.getElementById('operational-atk').value = clinic.realization.operational.atk;
                document.getElementById('operational-obat').value = clinic.realization.operational.obat;
                
                // Update modal table
                const modalTbody = document.getElementById('modal-table-body');
                if (modalTbody) {
                    modalTbody.innerHTML = '';
                    
                    clinic.realization.modal.forEach((item, index) => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${index + 1}</td>
                            <td>${item.nama}</td>
                            <td>${item.satuan}</td>
                            <td>Rp ${item.harga.toLocaleString('id-ID')}</td>
                            <td>${item.jumlah}</td>
                            <td>Rp ${item.total.toLocaleString('id-ID')}</td>
                            <td>
                                ${currentUser && currentUser.type === 'minkes' ? `
                                <button class="btn-warning edit-modal-btn" data-index="${index}">Edit</button>
                                <button class="btn-danger delete-modal-btn" data-index="${index}">Hapus</button>
                                ` : ''}
                            </td>
                        `;
                        modalTbody.appendChild(row);
                    });
                    
                    // Setup event listeners untuk tombol edit dan delete
                    if (currentUser && currentUser.type === 'minkes') {
                        document.querySelectorAll('.edit-modal-btn').forEach(button => {
                            button.addEventListener('click', function() {
                                const index = parseInt(this.getAttribute('data-index'));
                                editModalData(index);
                            });
                        });
                        
                        document.querySelectorAll('.delete-modal-btn').forEach(button => {
                            button.addEventListener('click', function() {
                                const index = parseInt(this.getAttribute('data-index'));
                                deleteModalData(index);
                            });
                        });
                    }
                }
            }
            
            // Simpan data honor
            function saveHonorData() {
                if (!currentClinic) return;
                
                const medis = parseInt(document.getElementById('honor-medis').value) || 0;
                const paramedis = parseInt(document.getElementById('honor-paramedis').value) || 0;
                const pengelola = parseInt(document.getElementById('honor-pengelola').value) || 0;
                
                // Update data
                currentClinic.realization.honor.medis = medis;
                currentClinic.realization.honor.paramedis = paramedis;
                currentClinic.realization.honor.pengelola = pengelola;
                
                alert('Data honor berhasil diperbarui!');
            }
            
            // Simpan data operasional
            function saveOperationalData() {
                if (!currentClinic) return;
                
                const atk = parseInt(document.getElementById('operational-atk').value) || 0;
                const obat = parseInt(document.getElementById('operational-obat').value) || 0;
                
                // Update data
                currentClinic.realization.operational.atk = atk;
                currentClinic.realization.operational.obat = obat;
                
                alert('Data operasional berhasil diperbarui!');
            }
            
            // Edit data modal
            function editModalData(index) {
                if (!currentClinic) return;
                
                const modalData = currentClinic.realization.modal[index];
                document.getElementById('modal-name').value = modalData.nama;
                document.getElementById('modal-unit').value = modalData.satuan;
                document.getElementById('modal-price').value = modalData.harga;
                document.getElementById('modal-quantity').value = modalData.jumlah;
                
                // Tampilkan form
                document.getElementById('modal-form').style.display = 'block';
                
                // Simpan index untuk update
                currentEditIndex = index;
            }
            
            // Simpan data modal
            function saveModalData() {
                if (!currentClinic) return;
                
                const name = document.getElementById('modal-name').value;
                const unit = document.getElementById('modal-unit').value;
                const price = parseInt(document.getElementById('modal-price').value);
                const quantity = parseInt(document.getElementById('modal-quantity').value);
                
                if (!name || !unit || isNaN(price) || isNaN(quantity)) {
                    alert('Mohon isi semua field dengan benar');
                    return;
                }
                
                const total = price * quantity;
                
                if (currentEditIndex !== null) {
                    // Update existing data
                    currentClinic.realization.modal[currentEditIndex] = { 
                        id: currentClinic.realization.modal[currentEditIndex].id,
                        nama: name, 
                        satuan: unit, 
                        harga: price, 
                        jumlah: quantity, 
                        total: total 
                    };
                    currentEditIndex = null;
                } else {
                    // Add new data
                    const newId = Date.now();
                    currentClinic.realization.modal.push({ 
                        id: newId,
                        nama: name, 
                        satuan: unit, 
                        harga: price, 
                        jumlah: quantity, 
                        total: total 
                    });
                }
                
                // Sembunyikan form
                document.getElementById('modal-form').style.display = 'none';
                
                // Reset form
                document.getElementById('modal-name').value = '';
                document.getElementById('modal-unit').value = '';
                document.getElementById('modal-price').value = '';
                document.getElementById('modal-quantity').value = '';
                
                // Refresh table
                loadClinicRealization(currentClinic);
                
                alert('Data belanja modal berhasil disimpan!');
            }
            
            // Hapus data modal
            function deleteModalData(index) {
                if (!currentClinic) return;
                
                if (confirm('Apakah Anda yakin ingin menghapus data belanja modal ini?')) {
                    currentClinic.realization.modal.splice(index, 1);
                    loadClinicRealization(currentClinic);
                    alert('Data belanja modal berhasil dihapus!');
                }
            }
            
            // Load data sisa anggaran klinik
            function loadClinicBudget(clinic) {
                // Update total values
                document.getElementById('total-budget').textContent = `Rp ${clinic.budget.totalBudget.toLocaleString('id-ID')}`;
                document.getElementById('total-spent').textContent = `Rp ${clinic.budget.totalSpent.toLocaleString('id-ID')}`;
                document.getElementById('remaining-budget').textContent = `Rp ${clinic.budget.remaining.toLocaleString('id-ID')}`;
                
                const tbody = document.getElementById('budget-table-body');
                if (!tbody) return;
                
                tbody.innerHTML = '';
                
                const yearFilter = document.getElementById('budget-year-filter').value;
                const monthFilter = document.getElementById('budget-month-filter').value;
                
                // Filter data berdasarkan tahun dan bulan
                let filteredBudget = clinic.budget.monthlyRemaining.filter(item => 
                    item.year.toString() === yearFilter
                );
                
                if (monthFilter !== 'all') {
                    filteredBudget = filteredBudget.filter(item => 
                        item.month.toString() === monthFilter
                    );
                }
                
                // Sort by month
                filteredBudget.sort((a, b) => a.month - b.month);
                
                filteredBudget.forEach((item, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${getMonthName(item.month)}</td>
                        <td>${item.year}</td>
                        <td>Rp ${item.budget.toLocaleString('id-ID')}</td>
                        <td>Rp ${item.spent.toLocaleString('id-ID')}</td>
                        <td>Rp ${item.remaining.toLocaleString('id-ID')}</td>
                        <td>
                            ${currentUser && currentUser.type === 'minkes' ? `
                            <button class="btn-warning edit-budget-btn" data-index="${index}">Edit</button>
                            <button class="btn-danger delete-budget-btn" data-index="${index}">Hapus</button>
                            ` : ''}
                        </td>
                    `;
                    tbody.appendChild(row);
                });
                
                // Setup event listeners untuk tombol edit dan delete
                if (currentUser && currentUser.type === 'minkes') {
                    document.querySelectorAll('.edit-budget-btn').forEach(button => {
                        button.addEventListener('click', function() {
                            const index = parseInt(this.getAttribute('data-index'));
                            editBudgetData(index);
                        });
                    });
                    
                    document.querySelectorAll('.delete-budget-btn').forEach(button => {
                        button.addEventListener('click', function() {
                            const index = parseInt(this.getAttribute('data-index'));
                            deleteBudgetData(index);
                        });
                    });
                }
            }
            
            // Edit data anggaran bulanan
            function editBudgetData(index) {
                if (!currentClinic) return;
                
                // Find the actual index in the original array
                const yearFilter = document.getElementById('budget-year-filter').value;
                const monthFilter = document.getElementById('budget-month-filter').value;
                
                let filteredIndex = 0;
                let actualIndex = -1;
                
                for (let i = 0; i < currentClinic.budget.monthlyRemaining.length; i++) {
                    const item = currentClinic.budget.monthlyRemaining[i];
                    if (item.year.toString() === yearFilter && 
                        (monthFilter === 'all' || item.month.toString() === monthFilter)) {
                        if (filteredIndex === index) {
                            actualIndex = i;
                            break;
                        }
                        filteredIndex++;
                    }
                }
                
                if (actualIndex === -1) return;
                
                const budgetData = currentClinic.budget.monthlyRemaining[actualIndex];
                document.getElementById('budget-month').value = budgetData.month;
                document.getElementById('budget-year').value = budgetData.year;
                document.getElementById('budget-amount').value = budgetData.budget;
                document.getElementById('budget-spent').value = budgetData.spent;
                
                // Tampilkan form
                document.getElementById('budget-form').style.display = 'block';
                document.getElementById('add-budget-btn').style.display = 'none';
                
                // Simpan index untuk update
                currentEditIndex = actualIndex;
            }
            
            // Simpan data anggaran bulanan
            function saveBudgetData() {
                if (!currentClinic) return;
                
                const month = parseInt(document.getElementById('budget-month').value);
                const year = parseInt(document.getElementById('budget-year').value);
                const budget = parseInt(document.getElementById('budget-amount').value);
                const spent = parseInt(document.getElementById('budget-spent').value);
                
                if (isNaN(month) || isNaN(year) || isNaN(budget) || isNaN(spent)) {
                    alert('Mohon isi semua field dengan benar');
                    return;
                }
                
                const remaining = budget - spent;
                
                if (currentEditIndex !== null) {
                    // Update existing data
                    currentClinic.budget.monthlyRemaining[currentEditIndex] = { 
                        month, 
                        year, 
                        budget, 
                        spent, 
                        remaining 
                    };
                    currentEditIndex = null;
                } else {
                    // Add new data
                    // Cek apakah data untuk bulan dan tahun ini sudah ada
                    const existingIndex = currentClinic.budget.monthlyRemaining.findIndex(b => b.month === month && b.year === year);
                    if (existingIndex !== -1) {
                        // Jika sudah ada, update data yang ada
                        currentClinic.budget.monthlyRemaining[existingIndex] = { month, year, budget, spent, remaining };
                    } else {
                        // Jika belum ada, tambahkan data baru
                        currentClinic.budget.monthlyRemaining.push({ month, year, budget, spent, remaining });
                    }
                }
                
                // Sembunyikan form dan tampilkan tombol add
                document.getElementById('budget-form').style.display = 'none';
                document.getElementById('add-budget-btn').style.display = 'inline-block';
                
                // Reset form
                document.getElementById('budget-month').value = '1';
                document.getElementById('budget-year').value = '2024';
                document.getElementById('budget-amount').value = '';
                document.getElementById('budget-spent').value = '';
                
                // Refresh table
                loadClinicBudget(currentClinic);
                
                alert('Data anggaran bulanan berhasil disimpan!');
            }
            
            // Hapus data anggaran bulanan
            function deleteBudgetData(index) {
                if (!currentClinic) return;
                
                // Find the actual index in the original array
                const yearFilter = document.getElementById('budget-year-filter').value;
                const monthFilter = document.getElementById('budget-month-filter').value;
                
                let filteredIndex = 0;
                let actualIndex = -1;
                
                for (let i = 0; i < currentClinic.budget.monthlyRemaining.length; i++) {
                    const item = currentClinic.budget.monthlyRemaining[i];
                    if (item.year.toString() === yearFilter && 
                        (monthFilter === 'all' || item.month.toString() === monthFilter)) {
                        if (filteredIndex === index) {
                            actualIndex = i;
                            break;
                        }
                        filteredIndex++;
                    }
                }
                
                if (actualIndex === -1) return;
                
                if (confirm('Apakah Anda yakin ingin menghapus data anggaran bulanan ini?')) {
                    currentClinic.budget.monthlyRemaining.splice(actualIndex, 1);
                    loadClinicBudget(currentClinic);
                    alert('Data anggaran bulanan berhasil dihapus!');
                }
            }
            
            // Load form edit klinik
            function loadClinicEditForm(clinic) {
                document.getElementById('edit-clinic-id').value = clinic.id;
                document.getElementById('edit-clinic-name').value = clinic.name;
                document.getElementById('edit-clinic-address').value = clinic.address;
                document.getElementById('edit-clinic-phone').value = clinic.phone;
                document.getElementById('edit-clinic-email').value = clinic.email;
                
                // Tampilkan preview gambar
                const imagePreview = document.getElementById('edit-clinic-image-preview');
                if (imagePreview) {
                    imagePreview.src = clinic.image;
                    imagePreview.style.display = 'block';
                }
            }
            
            // Simpan edit klinik
            function saveClinicEdit() {
                if (!currentClinic) return;
                
                const clinicId = parseInt(document.getElementById('edit-clinic-id').value);
                const clinicIndex = clinics.findIndex(c => c.id === clinicId);
                
                if (clinicIndex === -1) return;
                
                // Update data klinik
                clinics[clinicIndex].name = document.getElementById('edit-clinic-name').value;
                clinics[clinicIndex].address = document.getElementById('edit-clinic-address').value;
                clinics[clinicIndex].phone = document.getElementById('edit-clinic-phone').value;
                clinics[clinicIndex].email = document.getElementById('edit-clinic-email').value;
                
                // Update gambar jika ada file baru yang diupload
                const imageInput = document.getElementById('edit-clinic-image');
                if (imageInput.files && imageInput.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        clinics[clinicIndex].image = e.target.result;
                        // Update currentClinic
                        currentClinic.image = e.target.result;
                        
                        // Update gambar di detail klinik
                        const clinicImage = document.getElementById('clinic-image');
                        if (clinicImage) {
                            clinicImage.src = e.target.result;
                        }
                        
                        // Update icon
                        const clinicIcon = document.getElementById('clinic-icon');
                        if (clinicIcon) {
                            clinicIcon.textContent = clinics[clinicIndex].name.charAt(0);
                        }
                        
                        // Tampilkan pesan sukses
                        alert('Data klinik berhasil diperbarui!');
                        
                        // Kembali ke info klinik
                        showClinicInfo();
                    };
                    reader.readAsDataURL(imageInput.files[0]);
                } else {
                    // Jika tidak ada gambar baru, langsung update
                    // Update currentClinic
                    currentClinic.name = clinics[clinicIndex].name;
                    currentClinic.address = clinics[clinicIndex].address;
                    currentClinic.phone = clinics[clinicIndex].phone;
                    currentClinic.email = clinics[clinicIndex].email;
                    
                    // Update icon
                    const clinicIcon = document.getElementById('clinic-icon');
                    if (clinicIcon) {
                        clinicIcon.textContent = clinics[clinicIndex].name.charAt(0);
                    }
                    
                    // Tampilkan pesan sukses
                    alert('Data klinik berhasil diperbarui!');
                    
                    // Kembali ke info klinik
                    showClinicInfo();
                    
                    // Refresh daftar klinik
                    loadClinics();
                }
            }
            
            // Load data rekap
            function loadRecapData() {
                const tbody = document.getElementById('recap-table-body');
                if (!tbody) return;
                
                tbody.innerHTML = '';
                
                const yearFilter = document.getElementById('recap-year-filter').value;
                const monthFilter = document.getElementById('recap-month-filter').value;
                
                clinics.forEach((clinic, index) => {
                    let totalBudget = 0;
                    let totalRealization = 0;
                    
                    if (monthFilter === 'all') {
                        // Sum all months for the year
                        clinic.budget.monthlyRemaining.forEach(item => {
                            if (item.year.toString() === yearFilter) {
                                totalBudget += item.budget;
                                totalRealization += item.spent;
                            }
                        });
                    } else {
                        // Get specific month
                        const budgetData = clinic.budget.monthlyRemaining.find(item => 
                            item.year.toString() === yearFilter && item.month.toString() === monthFilter
                        );
                        
                        if (budgetData) {
                            totalBudget = budgetData.budget;
                            totalRealization = budgetData.spent;
                        }
                    }
                    
                    const remaining = totalBudget - totalRealization;
                    const percentage = totalBudget > 0 ? Math.round((totalRealization / totalBudget) * 100) : 0;
                    
                    const status = percentage < 50 ? 'warning' : percentage < 80 ? 'info' : 'success';
                    const statusText = percentage < 50 ? 'Rendah' : percentage < 80 ? 'Sedang' : 'Tinggi';
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${clinic.name}</td>
                        <td>Rp ${totalBudget.toLocaleString('id-ID')}</td>
                        <td>Rp ${totalRealization.toLocaleString('id-ID')}</td>
                        <td>Rp ${remaining.toLocaleString('id-ID')}</td>
                        <td>${percentage}%</td>
                        <td>
                            <span class="badge badge-${status}">${statusText}</span>
                            <button class="btn-success view-recap-btn" data-id="${clinic.id}" style="margin-top: 10px;">Detail</button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
                
                // Setup event listeners untuk tombol detail
                document.querySelectorAll('.view-recap-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const clinicId = parseInt(this.getAttribute('data-id'));
                        viewClinic(clinicId);
                    });
                });
            }
        </script>
        
        <style>
            .badge {
                display: inline-block;
                padding: 5px 10px;
                border-radius: 20px;
                font-size: 12px;
                font-weight: 500;
                color: white;
            }
            
            .badge-success {
                background-color: #10b981;
            }
            
            .badge-info {
                background-color: #0891b2;
            }
            
            .badge-warning {
                background-color: #f59e0b;
            }
            
            .badge-danger {
                background-color: #dc2626;
            }
        </style>
    </body>
</html>
