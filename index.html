<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FKTP DENKESYAH 02.04.03 - Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #1e3a8a;
            --primary-light: #3b82f6;
            --primary-dark: #1e40af;
            --secondary: #059669;
            --accent: #d97706;
            --danger: #dc2626;
            --warning: #f59e0b;
            --info: #0891b2;
            --success: #10b981;
            --light: #f8fafc;
            --dark: #1e293b;
            --gray-100: #f8fafc;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-color: #f1f5f9;
            color: var(--gray-800);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Login Styles */
        .login-container {
            max-width: 450px;
            margin: 100px auto;
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--gray-200);
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .login-header h1 {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .login-header p {
            color: var(--gray-600);
            font-size: 16px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--gray-700);
            font-size: 14px;
        }
        
        input[type="text"],
        input[type="password"],
        input[type="email"],
        input[type="number"],
        textarea,
        select,
        input[type="file"] {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background-color: white;
        }
        
        input[type="text"]:focus,
        input[type="password"]:focus,
        input[type="email"]:focus,
        input[type="number"]:focus,
        textarea:focus,
        select:focus,
        input[type="file"]:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
            outline: none;
        }
        
        button {
            background-color: var(--primary);
            color: white;
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
        }
        
        button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 58, 138, 0.3);
        }
        
        .btn-secondary {
            background-color: var(--gray-600);
        }
        
        .btn-secondary:hover {
            background-color: var(--gray-700);
        }
        
        .btn-success {
            background-color: var(--secondary);
        }
        
        .btn-success:hover {
            background-color: #047857;
        }
        
        .btn-danger {
            background-color: var(--danger);
        }
        
        .btn-danger:hover {
            background-color: #b91c1c;
        }
        
        .btn-warning {
            background-color: var(--accent);
        }
        
        .btn-warning:hover {
            background-color: #b45309;
        }
        
        .btn-info {
            background-color: var(--info);
        }
        
        .btn-info:hover {
            background-color: #0e7490;
        }
        
        .help-section {
            background-color: #dbeafe;
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            border: 1px solid #bfdbfe;
        }
        
        .error {
            background-color: #fee2e2;
            color: var(--danger);
            padding: 16px;
            border-radius: 12px;
            margin: 20px 0;
            border: 1px solid #fecaca;
            display: none;
            font-weight: 500;
        }
        
        /* Dashboard Styles */
        .dashboard {
            display: none;
        }
        
        .dashboard-header {
            background: white;
            padding: 25px 30px;
            border-radius: 16px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-200);
        }
        
        .dashboard-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .dashboard-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .dashboard-title h2 {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
        }
        
        .nav-buttons {
            display: flex;
            gap: 12px;
            padding: 10px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-200);
            margin-bottom: 30px;
        }
        
        .nav-btn {
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 15px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .nav-btn:hover {
            background: var(--gray-100);
        }
        
        .nav-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-200);
            margin-bottom: 30px;
        }
        
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--gray-200);
        }
        
        .content-title {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary);
        }
        
        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(30, 58, 138, 0.15);
            color: white;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(30, 58, 138, 0.2);
        }
        
        .stat-card.honor {
            background: linear-gradient(135deg, var(--secondary), #047857);
        }
        
        .stat-card.operational {
            background: linear-gradient(135deg, var(--accent), #b45309);
        }
        
        .stat-card.modal {
            background: linear-gradient(135deg, var(--info), #0e7490);
        }
        
        .stat-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 40px;
            opacity: 0.2;
        }
        
        .stat-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 15px;
            opacity: 0.9;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-trend {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .trend-up {
            color: #10b981;
        }
        
        .trend-down {
            color: var(--danger);
        }
        
        /* Chart Container */
        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-200);
            margin-bottom: 40px;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .chart-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
        }
        
        .chart-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .period-selector {
            display: flex;
            gap: 10px;
            background: var(--gray-100);
            padding: 8px;
            border-radius: 12px;
        }
        
        .period-btn {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .period-btn:hover {
            background: white;
        }
        
        .period-btn.active {
            background: var(--primary);
            color: white;
            border-radius: 8px;
        }
        
        .chart-wrapper {
            height: 400px;
            position: relative;
        }
        
        /* Filter Section */
        .filter-section {
            background: var(--gray-100);
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 30px;
            border: 1px solid var(--gray-200);
        }
        
        .filter-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--primary);
        }
        
        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        /* Tables */
        .table-container {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-200);
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        th, td {
            padding: 16px 20px;
            text-align: left;
            border-bottom: 1px solid var(--gray-200);
        }
        
        th {
            background-color: var(--gray-50);
            font-weight: 600;
            color: var(--primary);
            font-size: 15px;
        }
        
        tr:hover {
            background-color: var(--gray-50);
        }
        
        /* Clinic Grid */
        .clinic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }
        
        .clinic-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-200);
            transition: all 0.3s ease;
        }
        
        .clinic-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .clinic-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .clinic-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 600;
        }
        
        .clinic-name {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }
        
        .clinic-detail {
            margin-bottom: 10px;
            color: var(--gray-700);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .clinic-actions {
            display: flex;
            gap: 12px;
            margin-top: 25px;
            justify-content: flex-end;
        }
        
        /* Monthly Tabs */
        .monthly-tabs {
            display: flex;
            background: var(--gray-100);
            padding: 5px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        
        .monthly-tab {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            background: transparent;
        }
        
        .monthly-tab:hover {
            background: white;
        }
        
        .monthly-tab.active {
            background: var(--primary);
            color: white;
        }
        
        .monthly-content {
            display: none;
        }
        
        .monthly-content.active {
            display: block;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .dashboard-header-content {
                flex-direction: column;
                align-items: stretch;
            }
            
            .user-info {
                justify-content: space-between;
                padding-top: 15px;
            }
            
            .nav-buttons {
                flex-wrap: wrap;
            }
            
            .nav-btn {
                flex: 1;
                min-width: 120px;
                text-align: center;
            }
            
            .filter-grid {
                grid-template-columns: 1fr;
            }
            
            .clinic-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Section -->
        <div id="login-section" class="login-container">
            <div class="login-header">
                <h1>FKTP DENKESYAH 02.04.03</h1>
                <p>Sistem Manajemen Keuangan Klinik</p>
            </div>
            
            <div class="help-section">
                <h3 style="color: var(--primary); font-weight: 600; margin-bottom: 15px;">Petunjuk Login:</h3>
                <p style="margin: 8px 0;">• <strong>Username:</strong> minkes, <strong>Password:</strong> minkes123 (untuk akses minkes)</p>
                <p style="margin: 8px 0;">• <strong>Username:</strong> klinik, <strong>Password:</strong> klinik123 (untuk akses klinik)</p>
                <p style="margin: 8px 0;">• <strong>Username:</strong> user, <strong>Password:</strong> user123 (untuk akses user biasa)</p>
            </div>
            
            <div id="error-message" class="error">
                Username atau password salah
            </div>
            
            <form id="login-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" placeholder="Masukkan username" required>
                </div>
                
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Masukkan password" required>
                </div>
                
                <button type="submit" style="width: 100%;">Login</button>
            </form>
        </div>
        
        <!-- Dashboard Section -->
        <div id="dashboard-section" class="dashboard">
            <div class="dashboard-header">
                <div class="dashboard-header-content">
                    <div class="dashboard-title">
                        <h2>Dashboard FKTP DENKESYAH 02.04.03</h2>
                    </div>
                    <div class="user-info">
                        <div class="user-avatar" id="user-avatar">U</div>
                        <div>
                            <div id="user-display">Halo, User</div>
                            <div id="user-type-display" style="font-size: 14px; color: var(--gray-600);">-</div>
                        </div>
                        <button id="logout-btn" class="btn-danger">Logout</button>
                    </div>
                </div>
            </div>
            
            <div class="nav-buttons">
                <button id="btn-dashboard" class="nav-btn active">Dashboard</button>
                <button id="btn-clinics" class="nav-btn">Daftar Klinik</button>
                <button id="btn-recap" class="nav-btn">Rekap Total</button>
            </div>
            
            <!-- Dashboard Content -->
            <div id="dashboard-content" class="content">
                <div class="content-header">
                    <h3 class="content-title">Overview Sistem</h3>
                    <div class="filter-section">
                        <div class="filter-grid">
                            <div>
                                <label for="dashboard-year-filter">Tahun</label>
                                <select id="dashboard-year-filter" style="width: 100%;">
                                    <option value="2022">2022</option>
                                    <option value="2023">2023</option>
                                    <option value="2024" selected>2024</option>
                                    <option value="2025">2025</option>
                                    <option value="2026">2026</option>
                                    <option value="2027">2027</option>
                                    <option value="2028">2028</option>
                                    <option value="2029">2029</option>
                                </select>
                            </div>
                            <div>
                                <label for="dashboard-month-filter">Bulan</label>
                                <select id="dashboard-month-filter" style="width: 100%;">
                                    <option value="all">Semua Bulan</option>
                                    <option value="1">Januari</option>
                                    <option value="2">Februari</option>
                                    <option value="3">Maret</option>
                                    <option value="4">April</option>
                                    <option value="5">Mei</option>
                                    <option value="6">Juni</option>
                                    <option value="7">Juli</option>
                                    <option value="8">Agustus</option>
                                    <option value="9">September</option>
                                    <option value="10">Oktober</option>
                                    <option value="11">November</option>
                                    <option value="12">Desember</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">🏥</div>
                        <div class="stat-title">TOTAL KLINIK</div>
                        <div class="stat-value" id="total-clinics">10</div>
                        <div class="stat-trend trend-up">
                            <span>↑ 2.5%</span> dari bulan lalu
                        </div>
                    </div>
                    
                    <div class="stat-card honor">
                        <div class="stat-icon">💰</div>
                        <div class="stat-title">TOTAL PENDAPATAN</div>
                        <div class="stat-value" id="total-income">Rp 1.500.000.000</div>
                        <div class="stat-trend trend-up">
                            <span>↑ 5.2%</span> dari bulan lalu
                        </div>
                    </div>
                    
                    <div class="stat-card operational">
                        <div class="stat-icon">📊</div>
                        <div class="stat-title">TOTAL REALISASI</div>
                        <div class="stat-value" id="total-realization">Rp 1.200.000.000</div>
                        <div class="stat-trend trend-up">
                            <span>↑ 3.8%</span> dari bulan lalu
                        </div>
                    </div>
                    
                    <div class="stat-card modal">
                        <div class="stat-icon">📈</div>
                        <div class="stat-title">SISA ANGGARAN</div>
                        <div class="stat-value" id="total-remaining">Rp 300.000.000</div>
                        <div class="stat-trend trend-down">
                            <span>↓ 1.2%</span> dari bulan lalu
                        </div>
                    </div>
                </div>
                
                <!-- Chart Container -->
                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">Rekapan Anggaran Per Bulan</h3>
                        <div class="chart-controls">
                            <div class="period-selector">
                                <button class="period-btn active" data-period="1">1 Bulan</button>
                                <button class="period-btn" data-period="3">3 Bulan</button>
                                <button class="period-btn" data-period="6">6 Bulan</button>
                                <button class="period-btn" data-period="12">12 Bulan</button>
                                <button class="period-btn" data-period="all">Semua</button>
                            </div>
                        </div>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="budget-chart"></canvas>
                    </div>
                </div>
                
                <!-- Monthly Data Table -->
                <div class="table-container">
                    <h3 style="margin-bottom: 20px; color: var(--primary); font-weight: 700;">Data Anggaran Per Bulan</h3>
                    <table id="dashboard-budget-table">
                        <thead>
                            <tr>
                                <th>Bulan</th>
                                <th>Total Anggaran</th>
                                <th>Total Realisasi</th>
                                <th>Sisa Anggaran</th>
                                <th>Persentase Realisasi</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="dashboard-budget-table-body">
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Clinics Content -->
            <div id="clinics-content" class="content" style="display: none;">
                <div class="content-header">
                    <h3 class="content-title">Daftar Unit FKTP</h3>
                    <p style="color: var(--gray-600);">Klik pada klinik untuk melihat detail, laporan, dan melakukan edit (jika memiliki akses).</p>
                </div>
                
                <div class="clinic-grid" id="clinics-container">
                    <!-- Daftar klinik akan muncul di sini -->
                </div>
            </div>
            
            <!-- Clinic Detail Content -->
            <div id="clinic-detail-content" class="content" style="display: none;">
                <div class="content-header">
                    <h3 id="clinic-detail-title" class="content-title">Detail Klinik</h3>
                    <button id="back-to-clinics" class="btn-secondary">← Kembali ke Daftar Klinik</button>
                </div>
                
                <div class="monthly-tabs">
                    <button class="monthly-tab active" data-tab="info">Informasi Klinik</button>
                    <button class="monthly-tab" data-tab="income">Laporan Pendapatan</button>
                    <button class="monthly-tab" data-tab="realization">Realisasi Pendapatan</button>
                    <button class="monthly-tab" data-tab="budget">Sisa Anggaran</button>
                    <button class="monthly-tab" data-tab="edit">Edit Klinik</button>
                </div>
                
                <!-- Clinic Info Section -->
                <div id="info-content" class="monthly-content active">
                    <div class="clinic-header">
                        <div class="clinic-icon" id="clinic-icon">K</div>
                        <div>
                            <h4 id="clinic-name" class="clinic-name">-</h4>
                            <p id="clinic-address" style="color: var(--gray-600); margin: 5px 0;">-</p>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 30px;">
                        <div>
                            <h5 style="color: var(--primary); font-weight: 600; margin-bottom: 15px;">Informasi Kontak</h5>
                            <div class="clinic-detail">
                                <strong>📞 Telepon:</strong> <span id="clinic-phone">-</span>
                            </div>
                            <div class="clinic-detail">
                                <strong>✉️ Email:</strong> <span id="clinic-email">-</span>
                            </div>
                        </div>
                        
                        <div>
                            <h5 style="color: var(--primary); font-weight: 600; margin-bottom: 15px;">Statistik Klinik</h5>
                            <div class="clinic-detail">
                                <strong>📊 Total Pendapatan:</strong> <span id="clinic-total-income">Rp 0</span>
                            </div>
                            <div class="clinic-detail">
                                <strong>📈 Realisasi:</strong> <span id="clinic-total-realization">Rp 0</span>
                            </div>
                            <div class="clinic-detail">
                                <strong>💰 Sisa Anggaran:</strong> <span id="clinic-remaining-budget">Rp 0</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Income Report Section -->
                <div id="income-content" class="monthly-content">
                    <h4 style="color: var(--primary); font-weight: 700; margin-bottom: 25px;">Laporan Pendapatan Kapitasi BPJS</h4>
                    
                    <div class="filter-section">
                        <div class="filter-grid">
                            <div>
                                <label for="income-year-filter">Tahun</label>
                                <select id="income-year-filter" style="width: 100%;">
                                    <option value="2022">2022</option>
                                    <option value="2023">2023</option>
                                    <option value="2024" selected>2024</option>
                                    <option value="2025">2025</option>
                                    <option value="2026">2026</option>
                                    <option value="2027">2027</option>
                                    <option value="2028">2028</option>
                                    <option value="2029">2029</option>
                                </select>
                            </div>
                            <div>
                                <label for="income-month-filter">Bulan</label>
                                <select id="income-month-filter" style="width: 100%;">
                                    <option value="all">Semua Bulan</option>
                                    <option value="1">Januari</option>
                                    <option value="2">Februari</option>
                                    <option value="3">Maret</option>
                                    <option value="4">April</option>
                                    <option value="5">Mei</option>
                                    <option value="6">Juni</option>
                                    <option value="7">Juli</option>
                                    <option value="8">Agustus</option>
                                    <option value="9">September</option>
                                    <option value="10">Oktober</option>
                                    <option value="11">November</option>
                                    <option value="12">Desember</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <button id="add-income-btn" class="btn-success" style="display: none; margin: 20px 0;">+ Tambah Data Pendapatan</button>
                    
                    <div id="income-form" style="display: none; margin: 30px 0; padding: 25px; background: var(--gray-100); border-radius: 16px;">
                        <h5 style="color: var(--primary); font-weight: 600; margin-bottom: 20px;">Form Input Pendapatan</h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                            <div>
                                <label for="income-month">Bulan</label>
                                <select id="income-month" style="width: 100%;">
                                    <option value="1">Januari</option>
                                    <option value="2">Februari</option>
                                    <option value="3">Maret</option>
                                    <option value="4">April</option>
                                    <option value="5">Mei</option>
                                    <option value="6">Juni</option>
                                    <option value="7">Juli</option>
                                    <option value="8">Agustus</option>
                                    <option value="9">September</option>
                                    <option value="10">Oktober</option>
                                    <option value="11">November</option>
                                    <option value="12">Desember</option>
                                </select>
                            </div>
                            <div>
                                <label for="income-year">Tahun</label>
                                <select id="income-year" style="width: 100%;">
                                    <option value="2022">2022</option>
                                    <option value="2023">2023</option>
                                    <option value="2024" selected>2024</option>
                                    <option value="2025">2025</option>
                                    <option value="2026">2026</option>
                                    <option value="2027">2027</option>
                                    <option value="2028">2028</option>
                                    <option value="2029">2029</option>
                                </select>
                            </div>
                            <div>
                                <label for="income-amount">Jumlah Pendapatan (Rp)</label>
                                <input type="number" id="income-amount" min="0" placeholder="Masukkan jumlah pendapatan" style="width: 100%;">
                            </div>
                        </div>
                        <div style="display: flex; gap: 15px; justify-content: flex-end;">
                            <button type="button" id="save-income-btn" class="btn-success">Simpan</button>
                            <button type="button" id="cancel-income-btn" class="btn-secondary">Batal</button>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table id="income-table">
                            <thead>
                                <tr>
                                    <th>Bulan</th>
                                    <th>Tahun</th>
                                    <th>Jumlah Pendapatan (Rp)</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="income-table-body">
                                <!-- Data pendapatan akan muncul di sini -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Realization Report Section -->
                <div id="realization-content" class="monthly-content">
                    <h4 style="color: var(--primary); font-weight: 700; margin-bottom: 25px;">Realisasi Pendapatan</h4>
                    
                    <div class="filter-section">
                        <div class="filter-grid">
                            <div>
                                <label for="realization-year-filter">Tahun</label>
                                <select id="realization-year-filter" style="width: 100%;">
                                    <option value="2022">2022</option>
                                    <option value="2023">2023</option>
                                    <option value="2024" selected>2024</option>
                                    <option value="2025">2025</option>
                                    <option value="2026">2026</option>
                                    <option value="2027">2027</option>
                                    <option value="2028">2028</option>
                                    <option value="2029">2029</option>
                                </select>
                            </div>
                            <div>
                                <label for="realization-month-filter">Bulan</label>
                                <select id="realization-month-filter" style="width: 100%;">
                                    <option value="all">Semua Bulan</option>
                                    <option value="1">Januari</option>
                                    <option value="2">Februari</option>
                                    <option value="3">Maret</option>
                                    <option value="4">April</option>
                                    <option value="5">Mei</option>
                                    <option value="6">Juni</option>
                                    <option value="7">Juli</option>
                                    <option value="8">Agustus</option>
                                    <option value="9">September</option>
                                    <option value="10">Oktober</option>
                                    <option value="11">November</option>
                                    <option value="12">Desember</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 40px;">
                        <div class="chart-container">
                            <div class="chart-header">
                                <h5 class="chart-title">Distribusi Realisasi per Kategori</h5>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="realization-chart"></canvas>
                            </div>
                        </div>
                        
                        <div>
                            <h5 style="color: var(--primary); font-weight: 600; margin-bottom: 20px;">Honor/Jasa (30%)</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                                <div>
                                    <label for="honor-medis">Medis (Rp)</label>
                                    <input type="number" id="honor-medis" min="0" value="30000000" style="width: 100%;">
                                </div>
                                <div>
                                    <label for="honor-paramedis">Paramedis (Rp)</label>
                                    <input type="number" id="honor-paramedis" min="0" value="15000000" style="width: 100%;">
                                </div>
                                <div>
                                    <label for="honor-pengelola">Pengelola (Rp)</label>
                                    <input type="number" id="honor-pengelola" min="0" value="10000000" style="width: 100%;">
                                </div>
                            </div>
                            <button id="save-honor-btn" class="btn-success" style="width: 100%;">Update Honor</button>
                            
                            <h5 style="color: var(--primary); font-weight: 600; margin: 30px 0 20px 0;">Operasional (50%)</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                                <div>
                                    <label for="operational-atk">Belanja ATK (Rp)</label>
                                    <input type="number" id="operational-atk" min="0" value="25000000" style="width: 100%;">
                                </div>
                                <div>
                                    <label for="operational-obat">Belanja Obat (Rp)</label>
                                    <input type="number" id="operational-obat" min="0" value="55000000" style="width: 100%;">
                                </div>
                            </div>
                            <button id="save-operational-btn" class="btn-success" style="width: 100%;">Update Operasional</button>
                        </div>
                    </div>
                    
                    <h5 style="color: var(--primary); font-weight: 600; margin: 40px 0 20px 0;">Belanja Modal (20%)</h5>
                    <button id="add-modal-btn" class="btn-success" style="margin-bottom: 20px;">+ Tambah Item Belanja Modal</button>
                    
                    <div id="modal-form" style="display: none; margin: 30px 0; padding: 25px; background: var(--gray-100); border-radius: 16px;">
                        <h5 style="color: var(--primary); font-weight: 600; margin-bottom: 20px;">Form Input Item Belanja Modal</h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                            <div>
                                <label for="modal-name">Nama Barang</label>
                                <input type="text" id="modal-name" placeholder="Masukkan nama barang" style="width: 100%;">
                            </div>
                            <div>
                                <label for="modal-unit">Satuan</label>
                                <input type="text" id="modal-unit" placeholder="Masukkan satuan" style="width: 100%;">
                            </div>
                            <div>
                                <label for="modal-price">Harga (Rp)</label>
                                <input type="number" id="modal-price" min="0" placeholder="Masukkan harga" style="width: 100%;">
                            </div>
                            <div>
                                <label for="modal-quantity">Jumlah</label>
                                <input type="number" id="modal-quantity" min="1" placeholder="Masukkan jumlah" style="width: 100%;">
                            </div>
                        </div>
                        <div style="display: flex; gap: 15px; justify-content: flex-end;">
                            <button type="button" id="save-modal-btn" class="btn-success">Simpan Item</button>
                            <button type="button" id="cancel-modal-btn" class="btn-secondary">Batal</button>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table id="modal-table">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Nama Barang</th>
                                    <th>Satuan</th>
                                    <th>Harga</th>
                                    <th>Jumlah</th>
                                    <th>Total</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="modal-table-body">
                                <!-- Data belanja modal akan muncul di sini -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Budget Remaining Section -->
                <div id="budget-content" class="monthly-content">
                    <h4 style="color: var(--primary); font-weight: 700; margin-bottom: 25px;">Sisa Anggaran</h4>
                    
                    <div class="filter-section">
                        <div class="filter-grid">
                            <div>
                                <label for="budget-year-filter">Tahun</label>
                                <select id="budget-year-filter" style="width: 100%;">
                                    <option value="2022">2022</option>
                                    <option value="2023">2023</option>
                                    <option value="2024" selected>2024</option>
                                    <option value="2025">2025</option>
                                    <option value="2026">2026</option>
                                    <option value="2027">2027</option>
                                    <option value="2028">2028</option>
                                    <option value="2029">2029</option>
                                </select>
                            </div>
                            <div>
                                <label for="budget-month-filter">Bulan</label>
                                <select id="budget-month-filter" style="width: 100%;">
                                    <option value="all">Semua Bulan</option>
                                    <option value="1">Januari</option>
                                    <option value="2">Februari</option>
                                    <option value="3">Maret</option>
                                    <option value="4">April</option>
                                    <option value="5">Mei</option>
                                    <option value="6">Juni</option>
                                    <option value="7">Juli</option>
                                    <option value="8">Agustus</option>
                                    <option value="9">September</option>
                                    <option value="10">Oktober</option>
                                    <option value="11">November</option>
                                    <option value="12">Desember</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-grid" style="margin-bottom: 40px;">
                        <div class="stat-card">
                            <div class="stat-icon">💼</div>
                            <div class="stat-title">TOTAL ANGGARAN</div>
                            <div class="stat-value" id="total-budget">Rp 165.000.000</div>
                            <div class="stat-trend trend-up">
                                <span>↑ 2.1%</span> dari bulan lalu
                            </div>
                        </div>
                        
                        <div class="stat-card honor">
                            <div class="stat-icon">💸</div>
                            <div class="stat-title">TELAH DIGUNAKAN</div>
                            <div class="stat-value" id="total-spent">Rp 120.000.000</div>
                            <div class="stat-trend trend-up">
                                <span>↑ 3.5%</span> dari bulan lalu
                            </div>
                        </div>
                        
                        <div class="stat-card operational">
                            <div class="stat-icon">💰</div>
                            <div class="stat-title">SISA ANGGARAN</div>
                            <div class="stat-value" id="remaining-budget">Rp 45.000.000</div>
                            <div class="stat-trend trend-down">
                                <span>↓ 4.2%</span> dari bulan lalu
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-container" style="margin-bottom: 40px;">
                        <div class="chart-header">
                            <h5 class="chart-title">Penggunaan Anggaran per Kategori</h5>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="budget-category-chart"></canvas>
                        </div>
                    </div>
                    
                    <button id="add-budget-btn" class="btn-success" style="display: none; margin: 20px 0;">+ Tambah Data Anggaran Bulanan</button>
                    
                    <div id="budget-form" style="display: none; margin: 30px 0; padding: 25px; background: var(--gray-100); border-radius: 16px;">
                        <h5 style="color: var(--primary); font-weight: 600; margin-bottom: 20px;">Form Input Anggaran Bulanan</h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                            <div>
                                <label for="budget-month">Bulan</label>
                                <select id="budget-month" style="width: 100%;">
                                    <option value="1">Januari</option>
                                    <option value="2">Februari</option>
                                    <option value="3">Maret</option>
                                    <option value="4">April</option>
                                    <option value="5">Mei</option>
                                    <option value="6">Juni</option>
                                    <option value="7">Juli</option>
                                    <option value="8">Agustus</option>
                                    <option value="9">September</option>
                                    <option value="10">Oktober</option>
                                    <option value="11">November</option>
                                    <option value="12">Desember</option>
                                </select>
                            </div>
                            <div>
                                <label for="budget-year">Tahun</label>
                                <select id="budget-year" style="width: 100%;">
                                    <option value="2022">2022</option>
                                    <option value="2023">2023</option>
                                    <option value="2024" selected>2024</option>
                                    <option value="2025">2025</option>
                                    <option value="2026">2026</option>
                                    <option value="2027">2027</option>
                                    <option value="2028">2028</option>
                                    <option value="2029">2029</option>
                                </select>
                            </div>
                            <div>
                                <label for="budget-amount">Total Anggaran (Rp)</label>
                                <input type="number" id="budget-amount" min="0" placeholder="Masukkan total anggaran" style="width: 100%;">
                            </div>
                            <div>
                                <label for="budget-spent">Telah Digunakan (Rp)</label>
                                <input type="number" id="budget-spent" min="0" placeholder="Masukkan yang telah digunakan" style="width: 100%;">
                            </div>
                        </div>
                        <div style="display: flex; gap: 15px; justify-content: flex-end;">
                            <button type="button" id="save-budget-btn" class="btn-success">Simpan</button>
                            <button type="button" id="cancel-budget-btn" class="btn-secondary">Batal</button>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table id="budget-table">
                            <thead>
                                <tr>
                                    <th>Bulan</th>
                                    <th>Tahun</th>
                                    <th>Total Anggaran</th>
                                    <th>Telah Digunakan</th>
                                    <th>Sisa Anggaran</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="budget-table-body">
                                <!-- Data sisa anggaran bulanan akan muncul di sini -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Edit Clinic Form -->
                <div id="edit-content" class="monthly-content">
                    <h4 style="color: var(--primary); font-weight: 600; margin-bottom: 25px;">Edit Informasi Klinik</h4>
                    
                    <form id="edit-clinic-form">
                        <input type="hidden" id="edit-clinic-id">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                            <div>
                                <label for="edit-clinic-name">Nama Klinik</label>
                                <input type="text" id="edit-clinic-name" required style="width: 100%;">
                            </div>
                            <div>
                                <label for="edit-clinic-address">Alamat</label>
                                <input type="text" id="edit-clinic-address" required style="width: 100%;">
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                            <div>
                                <label for="edit-clinic-phone">Telepon</label>
                                <input type="text" id="edit-clinic-phone" required style="width: 100%;">
                            </div>
                            <div>
                                <label for="edit-clinic-email">Email</label>
                                <input type="email" id="edit-clinic-email" required style="width: 100%;">
                            </div>
                        </div>
                        <div style="margin-bottom: 30px;">
                            <label for="edit-clinic-image">Upload Gambar Klinik</label>
                            <div class="image-upload" id="image-upload-area" style="border: 2px dashed var(--gray-300); padding: 30px; text-align: center; border-radius: 12px; margin: 15px 0; cursor: pointer; transition: all 0.3s;">
                                <p style="margin: 0; font-size: 16px; color: var(--gray-600);">Klik atau drag file gambar ke sini</p>
                                <p style="margin: 10px 0 0 0; font-size: 14px; color: var(--gray-500);">Format yang didukung: JPG, PNG, GIF</p>
                            </div>
                            <input type="file" id="edit-clinic-image" accept="image/*" style="display: none;">
                            <img id="edit-clinic-image-preview" class="image-preview" src="" alt="Preview Gambar" style="width: 100%; height: 300px; object-fit: cover; border-radius: 12px; margin: 20px 0; border: 1px solid var(--gray-200);">
                        </div>
                        <div style="display: flex; gap: 15px; justify-content: flex-end;">
                            <button type="submit" class="btn-success">Simpan Perubahan</button>
                            <button type="button" id="cancel-edit-btn" class="btn-secondary">Batal</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Total Recap Content -->
            <div id="recap-content" class="content" style="display: none;">
                <div class="content-header">
                    <h3 class="content-title">Rekap Total Semua Unit FKTP</h3>
                    <div style="display: flex; gap: 15px;">
                        <button id="download-excel" class="btn-info">Download Excel</button>
                        <button id="download-powerpoint" class="btn-info">Download PowerPoint</button>
                    </div>
                </div>
                
                <div class="filter-section">
                    <div class="filter-grid">
                        <div>
                            <label for="recap-year-filter">Tahun</label>
                            <select id="recap-year-filter" style="width: 100%;">
                                <option value="2022">2022</option>
                                <option value="2023">2023</option>
                                <option value="2024" selected>2024</option>
                                <option value="2025">2025</option>
                                <option value="2026">2026</option>
                                <option value="2027">2027</option>
                                <option value="2028">2028</option>
                                <option value="2029">2029</option>
                            </select>
                        </div>
                        <div>
                            <label for="recap-month-filter">Bulan</label>
                            <select id="recap-month-filter" style="width: 100%;">
                                <option value="all">Semua Bulan</option>
                                <option value="1">Januari</option>
                                <option value="2">Februari</option>
                                <option value="3">Maret</option>
                                <option value="4">April</option>
                                <option value="5">Mei</option>
                                <option value="6">Juni</option>
                                <option value="7">Juli</option>
                                <option value="8">Agustus</option>
                                <option value="9">September</option>
                                <option value="10">Oktober</option>
                                <option value="11">November</option>
                                <option value="12">Desember</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container" style="margin-bottom: 40px;">
                    <div class="chart-header">
                        <h5 class="chart-title">Distribusi Anggaran per Klinik</h5>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="recap-chart"></canvas>
                    </div>
                </div>
                
                <div class="table-container">
                    <table id="recap-table">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Nama Unit</th>
                                <th>Total Pendapatan</th>
                                <th>Total Realisasi</th>
                                <th>Sisa</th>
                                <th>Persentase Realisasi</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="recap-table-body">
                            <!-- Data rekap akan muncul di sini -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <script>
            // Data klinik
            let clinics = [
                { 
                    id: 1, 
                    name: 'Klinik Gatam Kedaton', 
                    address: 'Jl. Gatot Subroto No. 123, Kedaton, Bandar Lampung', 
                    phone: '0721-1234567', 
                    email: 'gatamkedaton@fktpdenkesyah.com',
                    image: 'https://placehold.co/600x400/1e3a8a/ffffff?text=Klinik+Gatam+Kedaton',
                    income: generateSampleIncome(),
                    realization: {
                        honor: { medis: 30000000, paramedis: 15000000, pengelola: 10000000 },
                        operational: { atk: 25000000, obat: 55000000 },
                        modal: [
                            { id: 1, nama: 'Stetoskop', satuan: 'Unit', harga: 500000, jumlah: 5, total: 2500000 },
                            { id: 2, nama: 'Termometer Digital', satuan: 'Unit', harga: 300000, jumlah: 10, total: 3000000 },
                            { id: 3, nama: 'Tensimeter', satuan: 'Unit', harga: 800000, jumlah: 3, total: 2400000 }
                        ]
                    },
                    budget: {
                        totalBudget: 165000000,
                        totalSpent: 120000000,
                        remaining: 45000000,
                        monthlyRemaining: generateSampleBudget()
                    }
                },
                { 
                    id: 2, 
                    name: 'Polkes 02.10.08 Metro', 
                    address: 'Jl. Jenderal Sudirman No. 45, Metro', 
                    phone: '0725-2345678', 
                    email: 'polkes021008@fktpdenkesyah.com',
                    image: 'https://placehold.co/600x400/059669/ffffff?text=Polkes+02.10.08+Metro',
                    income: generateSampleIncome(),
                    realization: {
                        honor: { medis: 28000000, paramedis: 14000000, pengelola: 9000000 },
                        operational: { atk: 24000000, obat: 53000000 },
                        modal: [
                            { id: 4, nama: 'Stetoskop', satuan: 'Unit', harga: 500000, jumlah: 4, total: 2000000 },
                            { id: 5, nama: 'Termometer Digital', satuan: 'Unit', harga: 300000, jumlah: 8, total: 2400000 },
                            { id: 6, nama: 'Tensimeter', satuan: 'Unit', harga: 800000, jumlah: 2, total: 1600000 }
                        ]
                    },
                    budget: {
                        totalBudget: 158000000,
                        totalSpent: 115000000,
                        remaining: 43000000,
                        monthlyRemaining: generateSampleBudget()
                    }
                },
                { 
                    id: 3, 
                    name: 'Polkes 02.10.09 Kotabumi', 
                    address: 'Jl. Raya Kotabumi No. 78, Kotabumi', 
                    phone: '0724-3456789', 
                    email: 'polkes021009@fktpdenkesyah.com',
                    image: 'https://placehold.co/600x400/d97706/ffffff?text=Polkes+02.10.09+Kotabumi',
                    income: generateSampleIncome(),
                    realization: {
                        honor: { medis: 29000000, paramedis: 14500000, pengelola: 9500000 },
                        operational: { atk: 24500000, obat: 54000000 },
                        modal: [
                            { id: 7, nama: 'Stetoskop', satuan: 'Unit', harga: 500000, jumlah: 6, total: 3000000 },
                            { id: 8, nama: 'Termometer Digital', satuan: 'Unit', harga: 300000, jumlah: 12, total: 3600000 },
                            { id: 9, nama: 'Tensimeter', satuan: 'Unit', harga: 800000, jumlah: 4, total: 3200000 }
                        ]
                    },
                    budget: {
                        totalBudget: 162000000,
                        totalSpent: 118000000,
                        remaining: 44000000,
                        monthlyRemaining: generateSampleBudget()
                    }
                },
                { 
                    id: 4, 
                    name: 'Polkes 02.10.15 Kalianda', 
                    address: 'Jl. Raya Kalianda No. 23, Kalianda', 
                    phone: '0727-4567890', 
                    email: 'polkes021015@fktpdenkesyah.com',
                    image: 'https://placehold.co/600x400/7c3aed/ffffff?text=Polkes+02.10.15+Kalianda',
                    income: generateSampleIncome(),
                    realization: {
                        honor: { medis: 27000000, paramedis: 13500000, pengelola: 8500000 },
                        operational: { atk: 23000000, obat: 51000000 },
                        modal: [
                            { id: 10, nama: 'Stetoskop', satuan: 'Unit', harga: 500000, jumlah: 3, total: 1500000 },
                            { id: 11, nama: 'Termometer Digital', satuan: 'Unit', harga: 300000, jumlah: 7, total: 2100000 },
                            { id: 12, nama: 'Tensimeter', satuan: 'Unit', harga: 800000, jumlah: 2, total: 1600000 }
                        ]
                    },
                    budget: {
                        totalBudget: 156000000,
                        totalSpent: 112000000,
                        remaining: 44000000,
                        monthlyRemaining: generateSampleBudget()
                    }
                },
                { 
                    id: 5, 
                    name: 'Polkes 02.10.16 Liwa', 
                    address: 'Jl. Raya Liwa No. 56, Liwa', 
                    phone: '0728-5678901', 
                    email: 'polkes021016@fktpdenkesyah.com',
                    image: 'https://placehold.co/600x400/dc2626/ffffff?text=Polkes+02.10.16+Liwa',
                    income: generateSampleIncome(),
                    realization: {
                        honor: { medis: 28500000, paramedis: 14200000, pengelola: 9300000 },
                        operational: { atk: 24000000, obat: 53500000 },
                        modal: [
                            { id: 13, nama: 'Stetoskop', satuan: 'Unit', harga: 500000, jumlah: 5, total: 2500000 },
                            { id: 14, nama: 'Termometer Digital', satuan: 'Unit', harga: 300000, jumlah: 9, total: 2700000 },
                            { id: 15, nama: 'Tensimeter', satuan: 'Unit', harga: 800000, jumlah: 3, total: 2400000 }
                        ]
                    },
                    budget: {
                        totalBudget: 161000000,
                        totalSpent: 116000000,
                        remaining: 45000000,
                        monthlyRemaining: generateSampleBudget()
                    }
                },
                { 
                    id: 6, 
                    name: 'Polkes 02.10.17 Tanggamus', 
                    address: 'Jl. Raya Tanggamus No. 89, Tanggamus', 
                    phone: '0722-6789012', 
                    email: 'polkes021017@fktpdenkesyah.com',
                    image: 'https://placehold.co/600x400/0891b2/ffffff?text=Polkes+02.10.17+Tanggamus',
                    income: generateSampleIncome(),
                    realization: {
                        honor: { medis: 27500000, paramedis: 13800000, pengelola: 8700000 },
                        operational: { atk: 23500000, obat: 52000000 },
                        modal: [
                            { id: 16, nama: 'Stetoskop', satuan: 'Unit', harga: 500000, jumlah: 4, total: 2000000 },
                            { id: 17, nama: 'Termometer Digital', satuan: 'Unit', harga: 300000, jumlah: 8, total: 2400000 },
                            { id: 18, nama: 'Tensimeter', satuan: 'Unit', harga: 800000, jumlah: 2, total: 1600000 }
                        ]
                    },
                    budget: {
                        totalBudget: 158000000,
                        totalSpent: 114000000,
                        remaining: 44000000,
                        monthlyRemaining: generateSampleBudget()
                    }
                },
                { 
                    id: 7, 
                    name: 'Polkesdim 0426 Tulang Bawang', 
                    address: 'Jl. Raya Tulang Bawang No. 34, Tulang Bawang', 
                    phone: '0726-7890123', 
                    email: 'polkesdim0426@fktpdenkesyah.com',
                    image: 'https://placehold.co/600x400/6b7280/ffffff?text=Polkesdim+0426+Tulang+Bawang',
                    income: generateSampleIncome(),
                    realization: {
                        honor: { medis: 29500000, paramedis: 14700000, pengelola: 9800000 },
                        operational: { atk: 25000000, obat: 55500000 },
                        modal: [
                            { id: 19, nama: 'Stetoskop', satuan: 'Unit', harga: 500000, jumlah: 6, total: 3000000 },
                            { id: 20, nama: 'Termometer Digital', satuan: 'Unit', harga: 300000, jumlah: 11, total: 3300000 },
                            { id: 21, nama: 'Tensimeter', satuan: 'Unit', harga: 800000, jumlah: 4, total: 3200000 }
                        ]
                    },
                    budget: {
                        totalBudget: 163000000,
                        totalSpent: 118000000,
                        remaining: 45000000,
                        monthlyRemaining: generateSampleBudget()
                    }
                },
                { 
                    id: 8, 
                    name: 'Polkesdim 0427 Way Kanan', 
                    address: 'Jl. Raya Way Kanan No. 67, Way Kanan', 
                    phone: '0728-8901234', 
                    email: 'polkesdim0427@fktpdenkesyah.com',
                    image: 'https://placehold.co/600x400/059669/ffffff?text=Polkesdim+0427+Way+Kanan',
                    income: generateSampleIncome(),
                    realization: {
                        honor: { medis: 27000000, paramedis: 13500000, pengelola: 8500000 },
                        operational: { atk: 23000000, obat: 51500000 },
                        modal: [
                            { id: 22, nama: 'Stetoskop', satuan: 'Unit', harga: 500000, jumlah: 3, total: 1500000 },
                            { id: 23, nama: 'Termometer Digital', satuan: 'Unit', harga: 300000, jumlah: 7, total: 2100000 },
                            { id: 24, nama: 'Tensimeter', satuan: 'Unit', harga: 800000, jumlah: 2, total: 1600000 }
                        ]
                    },
                    budget: {
                        totalBudget: 157000000,
                        totalSpent: 113000000,
                        remaining: 44000000,
                        monthlyRemaining: generateSampleBudget()
                    }
                },
                { 
                    id: 9, 
                    name: 'Polkesdim 0429 Lamtim', 
                    address: 'Jl. Raya Lampung Timur No. 12, Lampung Timur', 
                    phone: '0725-9012345', 
                    email: 'polkesdim0429@fktpdenkesyah.com',
                    image: 'https://placehold.co/600x400/7c3aed/ffffff?text=Polkesdim+0429+Lamtim',
                    income: generateSampleIncome(),
                    realization: {
                        honor: { medis: 28000000, paramedis: 14000000, pengelola: 9000000 },
                        operational: { atk: 24000000, obat: 53000000 },
                        modal: [
                            { id: 25, nama: 'Stetoskop', satuan: 'Unit', harga: 500000, jumlah: 5, total: 2500000 },
                            { id: 26, nama: 'Termometer Digital', satuan: 'Unit', harga: 300000, jumlah: 9, total: 2700000 },
                            { id: 27, nama: 'Tensimeter', satuan: 'Unit', harga: 800000, jumlah: 3, total: 2400000 }
                        ]
                    },
                    budget: {
                        totalBudget: 160000000,
                        totalSpent: 115000000,
                        remaining: 45000000,
                        monthlyRemaining: generateSampleBudget()
                    }
                },
                { 
                    id: 10, 
                    name: 'Klinik Tonkes Yonif 143/TWEJ', 
                    address: 'Jl. Raya Sukadana No. 45, Lampung Timur', 
                    phone: '0725-0123456', 
                    email: 'tonkesyonif143@fktpdenkesyah.com',
                    image: 'https://placehold.co/600x400/dc2626/ffffff?text=Klinik+Tonkes+Yonif+143/TWEJ',
                    income: generateSampleIncome(),
                    realization: {
                        honor: { medis: 29000000, paramedis: 14500000, pengelola: 9500000 },
                        operational: { atk: 24500000, obat: 54000000 },
                        modal: [
                            { id: 28, nama: 'Stetoskop', satuan: 'Unit', harga: 500000, jumlah: 6, total: 3000000 },
                            { id: 29, nama: 'Termometer Digital', satuan: 'Unit', harga: 300000, jumlah: 10, total: 3000000 },
                            { id: 30, nama: 'Tensimeter', satuan: 'Unit', harga: 800000, jumlah: 3, total: 2400000 }
                        ]
                    },
                    budget: {
                        totalBudget: 162000000,
                        totalSpent: 117000000,
                        remaining: 45000000,
                        monthlyRemaining: generateSampleBudget()
                    }
                }
            ];
            
            // Generate sample income data for 2 years back and 5 years forward
            function generateSampleIncome() {
                const income = [];
                const currentYear = new Date().getFullYear();
                
                // 2 years back to 5 years forward
                for (let year = currentYear - 2; year <= currentYear + 5; year++) {
                    for (let month = 1; month <= 12; month++) {
                        // Generate random amount between 140M and 170M
                        const baseAmount = 140000000;
                        const randomVariance = Math.floor(Math.random() * 30000000);
                        const amount = baseAmount + randomVariance;
                        
                        income.push({
                            month: month,
                            year: year,
                            amount: amount
                        });
                    }
                }
                
                return income;
            }
            
            // Generate sample budget data for 2 years back and 5 years forward
            function generateSampleBudget() {
                const budget = [];
                const currentYear = new Date().getFullYear();
                
                // 2 years back to 5 years forward
                for (let year = currentYear - 2; year <= currentYear + 5; year++) {
                    for (let month = 1; month <= 12; month++) {
                        // Generate random budget between 150M and 170M
                        const baseBudget = 150000000;
                        const randomVariance = Math.floor(Math.random() * 20000000);
                        const budgetAmount = baseBudget + randomVariance;
                        
                        // Generate random spent between 75% and 85% of budget
                        const spentPercentage = 0.75 + (Math.random() * 0.1);
                        const spent = Math.floor(budgetAmount * spentPercentage);
                        const remaining = budgetAmount - spent;
                        
                        budget.push({
                            month: month,
                            year: year,
                            budget: budgetAmount,
                            spent: spent,
                            remaining: remaining
                        });
                    }
                }
                
                return budget;
            }
            
            // State aplikasi
            let currentUser = null;
            let currentClinic = null;
            let currentEditIndex = null;
            let budgetChart = null;
            let realizationChart = null;
            let recapChart = null;
            let budgetCategoryChart = null;
            
            // Tunggu hingga halaman sepenuhnya dimuat
            document.addEventListener('DOMContentLoaded', function() {
                console.log('Halaman telah dimuat');
                
                // Setup form login
                const loginForm = document.getElementById('login-form');
                if (loginForm) {
                    loginForm.addEventListener('submit', function(e) {
                        e.preventDefault();
                        handleLogin();
                    });
                }
                
                // Setup logout button
                const logoutBtn = document.getElementById('logout-btn');
                if (logoutBtn) {
                    logoutBtn.addEventListener('click', function() {
                        handleLogout();
                    });
                }
                
                // Setup navigation buttons
                setupNavigation();
                
                // Setup clinic detail tabs
                setupTabs();
                
                // Setup filters
                setupFilters();
                
                // Setup edit form
                setupEditForm();
                
                // Setup finance forms
                setupFinanceForms();
                
                // Setup image upload
                setupImageUpload();
                
                // Setup chart period selectors
                setupChartPeriodSelectors();
                
                // Cek apakah user sudah login sebelumnya
                checkSavedLogin();
                
                // Initialize charts
                initializeCharts();
            });
            
            // Fungsi login
            function handleLogin() {
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                // Validasi login
                if ((username === 'minkes' && password === 'minkes123') || 
                    (username === 'klinik' && password === 'klinik123') || 
                    (username === 'user' && password === 'user123')) {
                    
                    // Simpan user ke localStorage
                    try {
                        localStorage.setItem('fktpUser', JSON.stringify({
                            username: username,
                            type: username === 'minkes' ? 'minkes' : 'klinik',
                            isLoggedIn: true
                        }));
                    } catch (e) {
                        console.log('Gagal menyimpan ke localStorage:', e);
                    }
                    
                    // Set current user
                    currentUser = {
                        username: username,
                        type: username === 'minkes' ? 'minkes' : 'klinik'
                    };
                    
                    // Update user avatar
                    const userAvatar = document.getElementById('user-avatar');
                    if (userAvatar) {
                        userAvatar.textContent = username.charAt(0).toUpperCase();
                    }
                    
                    // Tampilkan dashboard
                    document.getElementById('login-section').style.display = 'none';
                    document.getElementById('dashboard-section').style.display = 'block';
                    document.getElementById('user-display').textContent = `Halo, ${username}`;
                    document.getElementById('user-type-display').textContent = username === 'minkes' ? 'Admin' : 'Klinik';
                    
                    // Load data klinik
                    loadClinics();
                    
                    // Tampilkan dashboard content
                    showDashboard();
                    
                    // Initialize charts
                    updateDashboardCharts();
                    loadDashboardBudgetTable();
                } else {
                    document.getElementById('error-message').style.display = 'block';
                }
            }
            
            // Fungsi logout
            function handleLogout() {
                try {
                    localStorage.removeItem('fktpUser');
                } catch (e) {
                    console.log('Gagal menghapus dari localStorage:', e);
                }
                
                currentUser = null;
                currentClinic = null;
                
                document.getElementById('login-section').style.display = 'block';
                document.getElementById('dashboard-section').style.display = 'none';
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                document.getElementById('error-message').style.display = 'none';
            }
            
            // Cek login yang tersimpan
            function checkSavedLogin() {
                try {
                    const savedUser = localStorage.getItem('fktpUser');
                    if (savedUser) {
                        const userData = JSON.parse(savedUser);
                        if (userData.isLoggedIn) {
                            currentUser = {
                                username: userData.username,
                                type: userData.type
                            };
                            
                            // Update user avatar
                            const userAvatar = document.getElementById('user-avatar');
                            if (userAvatar) {
                                userAvatar.textContent = userData.username.charAt(0).toUpperCase();
                            }
                            
                            document.getElementById('login-section').style.display = 'none';
                            document.getElementById('dashboard-section').style.display = 'block';
                            document.getElementById('user-display').textContent = `Halo, ${userData.username}`;
                            document.getElementById('user-type-display').textContent = userData.type === 'minkes' ? 'Admin' : 'Klinik';
                            
                            loadClinics();
                            showDashboard();
                            updateDashboardCharts();
                            loadDashboardBudgetTable();
                        }
                    }
                } catch (e) {
                    console.log('Error saat mengecek login yang tersimpan:', e);
                }
            }
            
            // Setup navigation
            function setupNavigation() {
                // Dashboard button
                const dashboardBtn = document.getElementById('btn-dashboard');
                if (dashboardBtn) {
                    dashboardBtn.addEventListener('click', function() {
                        showDashboard();
                    });
                }
                
                // Clinics button
                const clinicsBtn = document.getElementById('btn-clinics');
                if (clinicsBtn) {
                    clinicsBtn.addEventListener('click', function() {
                        showClinics();
                    });
                }
                
                // Recap button
                const recapBtn = document.getElementById('btn-recap');
                if (recapBtn) {
                    recapBtn.addEventListener('click', function() {
                        showRecap();
                    });
                }
                
                // Back to clinics button
                const backToClinicsBtn = document.getElementById('back-to-clinics');
                if (backToClinicsBtn) {
                    backToClinicsBtn.addEventListener('click', function() {
                        showClinics();
                    });
                }
            }
            
            // Setup tabs
            function setupTabs() {
                const tabs = document.querySelectorAll('.monthly-tab');
                tabs.forEach(tab => {
                    tab.addEventListener('click', function() {
                        // Remove active class from all tabs
                        tabs.forEach(t => t.classList.remove('active'));
                        // Add active class to clicked tab
                        this.classList.add('active');
                        
                        // Hide all content
                        document.querySelectorAll('.monthly-content').forEach(content => {
                            content.classList.remove('active');
                        });
                        
                        // Show selected content
                        const tabId = this.getAttribute('data-tab');
                        document.getElementById(`${tabId}-content`).classList.add('active');
                        
                        // Load data if needed
                        if (currentClinic) {
                            if (tabId === 'income') {
                                loadClinicIncome(currentClinic);
                            } else if (tabId === 'realization') {
                                loadClinicRealization(currentClinic);
                                updateRealizationChart();
                            } else if (tabId === 'budget') {
                                loadClinicBudget(currentClinic);
                                updateBudgetCategoryChart();
                            } else if (tabId === 'edit') {
                                loadClinicEditForm(currentClinic);
                            }
                        }
                    });
                });
            }
            
            // Setup filters
            function setupFilters() {
                // Dashboard filters
                const dashboardYearFilter = document.getElementById('dashboard-year-filter');
                const dashboardMonthFilter = document.getElementById('dashboard-month-filter');
                
                if (dashboardYearFilter) {
                    dashboardYearFilter.addEventListener('change', function() {
                        updateDashboardCharts();
                        loadDashboardBudgetTable();
                    });
                }
                
                if (dashboardMonthFilter) {
                    dashboardMonthFilter.addEventListener('change', function() {
                        updateDashboardCharts();
                        loadDashboardBudgetTable();
                    });
                }
                
                // Income filters
                const incomeYearFilter = document.getElementById('income-year-filter');
                const incomeMonthFilter = document.getElementById('income-month-filter');
                
                if (incomeYearFilter) {
                    incomeYearFilter.addEventListener('change', function() {
                        if (currentClinic) {
                            loadClinicIncome(currentClinic);
                        }
                    });
                }
                
                if (incomeMonthFilter) {
                    incomeMonthFilter.addEventListener('change', function() {
                        if (currentClinic) {
                            loadClinicIncome(currentClinic);
                        }
                    });
                }
                
                // Realization filters
                const realizationYearFilter = document.getElementById('realization-year-filter');
                const realizationMonthFilter = document.getElementById('realization-month-filter');
                
                if (realizationYearFilter) {
                    realizationYearFilter.addEventListener('change', function() {
                        if (currentClinic) {
                            loadClinicRealization(currentClinic);
                            updateRealizationChart();
                        }
                    });
                }
                
                if (realizationMonthFilter) {
                    realizationMonthFilter.addEventListener('change', function() {
                        if (currentClinic) {
                            loadClinicRealization(currentClinic);
                            updateRealizationChart();
                        }
                    });
                }
                
                // Budget filters
                const budgetYearFilter = document.getElementById('budget-year-filter');
                const budgetMonthFilter = document.getElementById('budget-month-filter');
                
                if (budgetYearFilter) {
                    budgetYearFilter.addEventListener('change', function() {
                        if (currentClinic) {
                            loadClinicBudget(currentClinic);
                            updateBudgetCategoryChart();
                        }
                    });
                }
                
                if (budgetMonthFilter) {
                    budgetMonthFilter.addEventListener('change', function() {
                        if (currentClinic) {
                            loadClinicBudget(currentClinic);
                            updateBudgetCategoryChart();
                        }
                    });
                }
                
                // Recap filters
                const recapYearFilter = document.getElementById('recap-year-filter');
                const recapMonthFilter = document.getElementById('recap-month-filter');
                
                if (recapYearFilter) {
                    recapYearFilter.addEventListener('change', function() {
                        updateRecapChart();
                        loadRecapData();
                    });
                }
                
                if (recapMonthFilter) {
                    recapMonthFilter.addEventListener('change', function() {
                        updateRecapChart();
                        loadRecapData();
                    });
                }
            }
            
            // Setup edit form
            function setupEditForm() {
                const editForm = document.getElementById('edit-clinic-form');
                if (editForm) {
                    editForm.addEventListener('submit', function(e) {
                        e.preventDefault();
                        saveClinicEdit();
                    });
                }
                
                const cancelEditBtn = document.getElementById('cancel-edit-btn');
                if (cancelEditBtn) {
                    cancelEditBtn.addEventListener('click', function() {
                        showClinicInfo();
                    });
                }
            }
            
            // Setup finance forms
            function setupFinanceForms() {
                // Income form buttons
                const addIncomeBtn = document.getElementById('add-income-btn');
                const saveIncomeBtn = document.getElementById('save-income-btn');
                const cancelIncomeBtn = document.getElementById('cancel-income-btn');
                
                if (addIncomeBtn) {
                    addIncomeBtn.addEventListener('click', function() {
                        document.getElementById('income-form').style.display = 'block';
                        this.style.display = 'inline-block';
                    });
                }
                
                if (cancelIncomeBtn) {
                    cancelIncomeBtn.addEventListener('click', function() {
                        document.getElementById('income-form').style.display = 'none';
                        document.getElementById('add-income-btn').style.display = 'inline-block';
                    });
                }
                
                if (saveIncomeBtn) {
                    saveIncomeBtn.addEventListener('click', function() {
                        saveIncomeData();
                    });
                }
                
                // Honor buttons
                const saveHonorBtn = document.getElementById('save-honor-btn');
                if (saveHonorBtn) {
                    saveHonorBtn.addEventListener('click', function() {
                        saveHonorData();
                        if (currentClinic) {
                            updateRealizationChart();
                        }
                    });
                }
                
                // Operational buttons
                const saveOperationalBtn = document.getElementById('save-operational-btn');
                if (saveOperationalBtn) {
                    saveOperationalBtn.addEventListener('click', function() {
                        saveOperationalData();
                        if (currentClinic) {
                            updateRealizationChart();
                        }
                    });
                }
                
                // Modal form buttons
                const addModalBtn = document.getElementById('add-modal-btn');
                const saveModalBtn = document.getElementById('save-modal-btn');
                const cancelModalBtn = document.getElementById('cancel-modal-btn');
                
                if (addModalBtn) {
                    addModalBtn.addEventListener('click', function() {
                        document.getElementById('modal-form').style.display = 'block';
                    });
                }
                
                if (cancelModalBtn) {
                    cancelModalBtn.addEventListener('click', function() {
                        document.getElementById('modal-form').style.display = 'none';
                    });
                }
                
                if (saveModalBtn) {
                    saveModalBtn.addEventListener('click', function() {
                        saveModalData();
                    });
                }
                
                // Budget form buttons
                const addBudgetBtn = document.getElementById('add-budget-btn');
                const saveBudgetBtn = document.getElementById('save-budget-btn');
                const cancelBudgetBtn = document.getElementById('cancel-Budget-btn');

                if (addBudgetBtn) {
                    addBudgetBtn.addEventListener('click', function() {
                        document.getElementById('budget-form').style.display = 'block';
                        this.style.display = 'inline-block';
                    });
                }
                
                if (cancelBudgetBtn) {
                    cancelBudgetBtn.addEventListener('click', function() {
                        document.getElementById('budget-form').style.display = 'none';
                        document.getElementById('add-budget-btn').style.display = 'inline-block';
                    });
                }
                
                if (saveBudgetBtn) {
                    saveBudgetBtn.addEventListener('click', function() {
                        saveBudgetData();
                        if (currentClinic) {
                            updateBudgetCategoryChart();
                        }
                    });
                }
                
                // Export buttons
                const downloadExcelBtn = document.getElementById('download-excel');
                const downloadPowerPointBtn = document.getElementById('download-powerpoint');
                
                if (downloadExcelBtn) {
                    downloadExcelBtn.addEventListener('click', function() {
                        downloadExcelReport();
                    });
                }
                
                if (downloadPowerPointBtn) {
                    downloadPowerPointBtn.addEventListener('click', function() {
                        downloadPowerPointReport();
                    });
                }
            }
            
            // Setup image upload
            function setupImageUpload() {
                const imageUploadArea = document.getElementById('image-upload-area');
                const imageInput = document.getElementById('edit-clinic-image');
                const imagePreview = document.getElementById('edit-clinic-image-preview');
                
                if (imageUploadArea && imageInput) {
                    // Click to upload
                    imageUploadArea.addEventListener('click', function() {
                        imageInput.click();
                    });
                    
                    // File selection
                    imageInput.addEventListener('change', function() {
                        handleImageUpload();
                    });
                }
            }
            
            // Handle image upload
            function handleImageUpload() {
                const imageInput = document.getElementById('edit-clinic-image');
                const imagePreview = document.getElementById('edit-clinic-image-preview');
                
                if (imageInput.files && imageInput.files[0]) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        imagePreview.src = e.target.result;
                        imagePreview.style.display = 'block';
                    };
                    
                    reader.readAsDataURL(imageInput.files[0]);
                }
            }
            
            // Setup chart period selectors
            function setupChartPeriodSelectors() {
                const periodButtons = document.querySelectorAll('.period-btn');
                periodButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        // Remove active class from all buttons
                        periodButtons.forEach(btn => btn.classList.remove('active'));
                        // Add active class to clicked button
                        this.classList.add('active');
                        
                        // Update charts with selected period
                        updateDashboardCharts();
                    });
                });
            }
            
            // Initialize charts
            function initializeCharts() {
                // Initialize budget chart
                const budgetChartCtx = document.getElementById('budget-chart');
                if (budgetChartCtx) {
                    budgetChart = new Chart(budgetChartCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'],
                            datasets: [
                                {
                                    label: 'Total Anggaran',
                                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: 'rgba(30, 58, 138, 0.2)',
                                    borderColor: '#1e3a8a',
                                    borderWidth: 3,
                                    pointBackgroundColor: '#1e3a8a',
                                    pointRadius: 5,
                                    pointHoverRadius: 7,
                                    fill: true,
                                    tension: 0.3
                                },
                                {
                                    label: 'Total Realisasi',
                                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: 'rgba(5, 150, 105, 0.2)',
                                    borderColor: '#059669',
                                    borderWidth: 3,
                                    pointBackgroundColor: '#059669',
                                    pointRadius
                                                  // Add total row
                const totalRow = document.createElement('tr');
                totalRow.style.fontWeight = 'bold';
                totalRow.style.backgroundColor = '#f8fafc';
                totalRow.innerHTML = `
                    <td colspan="2"><strong>TOTAL</strong></td>
                    <td><strong>Rp ${total.toLocaleString('id-ID')}</strong></td>
                    <td></td>
                `;
                tbody.appendChild(totalRow);
            }
            
            // Edit data pendapatan
            function editIncomeData(index) {
                if (!currentClinic) return;
                
                // Find the actual index in the original array
                const yearFilter = document.getElementById('income-year-filter').value;
                const monthFilter = document.getElementById('income-month-filter').value;
                
                let filteredIndex = 0;
                let actualIndex = -1;
                
                for (let i = 0; i < currentClinic.income.length; i++) {
                    const item = currentClinic.income[i];
                    if (item.year.toString() === yearFilter && 
                        (monthFilter === 'all' || item.month.toString() === monthFilter)) {
                        if (filteredIndex === index) {
                            actualIndex = i;
                            break;
                        }
                        filteredIndex++;
                    }
                }
                
                if (actualIndex === -1) return;
                
                const incomeData = currentClinic.income[actualIndex];
                document.getElementById('income-month').value = incomeData.month;
                document.getElementById('income-year').value = incomeData.year;
                document.getElementById('income-amount').value = incomeData.amount;
                
                // Tampilkan form
                document.getElementById('income-form').style.display = 'block';
                document.getElementById('add-income-btn').style.display = 'none';
                
                // Simpan index untuk update
                currentEditIndex = actualIndex;
            }
            
            // Simpan data pendapatan
            function saveIncomeData() {
                if (!currentClinic) return;
                
                const month = parseInt(document.getElementById('income-month').value);
                const year = parseInt(document.getElementById('income-year').value);
                const amount = parseInt(document.getElementById('income-amount').value);
                
                if (isNaN(month) || isNaN(year) || isNaN(amount)) {
                    alert('Mohon isi semua field dengan benar');
                    return;
                }
                
                if (currentEditIndex !== null) {
                    // Update existing data
                    currentClinic.income[currentEditIndex] = { month, year, amount };
                    currentEditIndex = null;
                } else {
                    // Add new data
                    // Cek apakah data untuk bulan dan tahun ini sudah ada
                    const existingIndex = currentClinic.income.findIndex(i => i.month === month && i.year === year);
                    if (existingIndex !== -1) {
                        // Jika sudah ada, update data yang ada
                        currentClinic.income[existingIndex] = { month, year, amount };
                    } else {
                        // Jika belum ada, tambahkan data baru
                        currentClinic.income.push({ month, year, amount });
                    }
                }
                
                // Sembunyikan form dan tampilkan tombol add
                document.getElementById('income-form').style.display = 'none';
                document.getElementById('add-income-btn').style.display = 'inline-block';
                
                // Reset form
                document.getElementById('income-month').value = '1';
                document.getElementById('income-year').value = '2024';
                document.getElementById('income-amount').value = '';
                
                // Refresh table
                loadClinicIncome(currentClinic);
                
                alert('Data pendapatan berhasil disimpan!');
            }
            
            // Hapus data pendapatan
            function deleteIncomeData(index) {
                if (!currentClinic) return;
                
                // Find the actual index in the original array
                const yearFilter = document.getElementById('income-year-filter').value;
                const monthFilter = document.getElementById('income-month-filter').value;
                
                let filteredIndex = 0;
                let actualIndex = -1;
                
                for (let i = 0; i < currentClinic.income.length; i++) {
                    const item = currentClinic.income[i];
                    if (item.year.toString() === yearFilter && 
                        (monthFilter === 'all' || item.month.toString() === monthFilter)) {
                        if (filteredIndex === index) {
                            actualIndex = i;
                            break;
                        }
                        filteredIndex++;
                    }
                }
                
                if (actualIndex === -1) return;
                
                if (confirm('Apakah Anda yakin ingin menghapus data pendapatan ini?')) {
                    currentClinic.income.splice(actualIndex, 1);
                    loadClinicIncome(currentClinic);
                    alert('Data pendapatan berhasil dihapus!');
                }
            }
            
            // Load data realisasi klinik
            function loadClinicRealization(clinic) {
                // Update honor values
                document.getElementById('honor-medis').value = clinic.realization.honor.medis;
                document.getElementById('honor-paramedis').value = clinic.realization.honor.paramedis;
                document.getElementById('honor-pengelola').value = clinic.realization.honor.pengelola;
                
                // Update operational values
                document.getElementById('operational-atk').value = clinic.realization.operational.atk;
                document.getElementById('operational-obat').value = clinic.realization.operational.obat;
                
                // Update modal table
                const modalTbody = document.getElementById('modal-table-body');
                if (modalTbody) {
                    modalTbody.innerHTML = '';
                    
                    clinic.realization.modal.forEach((item, index) => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${index + 1}</td>
                            <td>${item.nama}</td>
                            <td>${item.satuan}</td>
                            <td>Rp ${item.harga.toLocaleString('id-ID')}</td>
                            <td>${item.jumlah}</td>
                            <td>Rp ${item.total.toLocaleString('id-ID')}</td>
                            <td>
                                ${currentUser && currentUser.type === 'minkes' ? `
                                <button class="btn-warning edit-modal-btn" data-index="${index}">Edit</button>
                                <button class="btn-danger delete-modal-btn" data-index="${index}">Hapus</button>
                                ` : ''}
                            </td>
                        `;
                        modalTbody.appendChild(row);
                    });
                    
                    // Setup event listeners untuk tombol edit dan delete
                    if (currentUser && currentUser.type === 'minkes') {
                        document.querySelectorAll('.edit-modal-btn').forEach(button => {
                            button.addEventListener('click', function() {
                                const index = parseInt(this.getAttribute('data-index'));
                                editModalData(index);
                            });
                        });
                        
                        document.querySelectorAll('.delete-modal-btn').forEach(button => {
                            button.addEventListener('click', function() {
                                const index = parseInt(this.getAttribute('data-index'));
                                deleteModalData(index);
                            });
                        });
                    }
                }
            }
            
            // Simpan data honor
            function saveHonorData() {
                if (!currentClinic) return;
                
                const medis = parseInt(document.getElementById('honor-medis').value) || 0;
                const paramedis = parseInt(document.getElementById('honor-paramedis').value) || 0;
                const pengelola = parseInt(document.getElementById('honor-pengelola').value) || 0;
                
                // Update data
                currentClinic.realization.honor.medis = medis;
                currentClinic.realization.honor.paramedis = paramedis;
                currentClinic.realization.honor.pengelola = pengelola;
                
                alert('Data honor berhasil diperbarui!');
            }
            
            // Simpan data operasional
            function saveOperationalData() {
                if (!currentClinic) return;
                
                const atk = parseInt(document.getElementById('operational-atk').value) || 0;
                const obat = parseInt(document.getElementById('operational-obat').value) || 0;
                
                // Update data
                currentClinic.realization.operational.atk = atk;
                currentClinic.realization.operational.obat = obat;
                
                alert('Data operasional berhasil diperbarui!');
            }
            
            // Edit data modal
            function editModalData(index) {
                if (!currentClinic) return;
                
                const modalData = currentClinic.realization.modal[index];
                document.getElementById('modal-name').value = modalData.nama;
                document.getElementById('modal-unit').value = modalData.satuan;
                document.getElementById('modal-price').value = modalData.harga;
                document.getElementById('modal-quantity').value = modalData.jumlah;
                
                // Tampilkan form
                document.getElementById('modal-form').style.display = 'block';
                
                // Simpan index untuk update
                currentEditIndex = index;
            }
            
            // Simpan data modal
            function saveModalData() {
                if (!currentClinic) return;
                
                const name = document.getElementById('modal-name').value;
                const unit = document.getElementById('modal-unit').value;
                const price = parseInt(document.getElementById('modal-price').value);
                const quantity = parseInt(document.getElementById('modal-quantity').value);
                
                if (!name || !unit || isNaN(price) || isNaN(quantity)) {
                    alert('Mohon isi semua field dengan benar');
                    return;
                }
                
                const total = price * quantity;
                
                if (currentEditIndex !== null) {
                    // Update existing data
                    currentClinic.realization.modal[currentEditIndex] = { 
                        id: currentClinic.realization.modal[currentEditIndex].id,
                        nama: name, 
                        satuan: unit, 
                        harga: price, 
                        jumlah: quantity, 
                        total: total 
                    };
                    currentEditIndex = null;
                } else {
                    // Add new data
                    const newId = Date.now();
                    currentClinic.realization.modal.push({ 
                        id: newId,
                        nama: name, 
                        satuan: unit, 
                        harga: price, 
                        jumlah: quantity, 
                        total: total 
                    });
                }
                
                // Sembunyikan form
                document.getElementById('modal-form').style.display = 'none';
                
                // Reset form
                document.getElementById('modal-name').value = '';
                document.getElementById('modal-unit').value = '';
                document.getElementById('modal-price').value = '';
                document.getElementById('modal-quantity').value = '';
                
                // Refresh table
                loadClinicRealization(currentClinic);
                
                alert('Data belanja modal berhasil disimpan!');
            }
            
            // Hapus data modal
            function deleteModalData(index) {
                if (!currentClinic) return;
                
                if (confirm('Apakah Anda yakin ingin menghapus data belanja modal ini?')) {
                    currentClinic.realization.modal.splice(index, 1);
                    loadClinicRealization(currentClinic);
                    alert('Data belanja modal berhasil dihapus!');
                }
            }
            
            // Load data sisa anggaran klinik
            function loadClinicBudget(clinic) {
                // Update total values
                document.getElementById('total-budget').textContent = `Rp ${clinic.budget.totalBudget.toLocaleString('id-ID')}`;
                document.getElementById('total-spent').textContent = `Rp ${clinic.budget.totalSpent.toLocaleString('id-ID')}`;
                document.getElementById('remaining-budget').textContent = `Rp ${clinic.budget.remaining.toLocaleString('id-ID')}`;
                
                const tbody = document.getElementById('budget-table-body');
                if (!tbody) return;
                
                tbody.innerHTML = '';
                
                const yearFilter = document.getElementById('budget-year-filter').value;
                const monthFilter = document.getElementById('budget-month-filter').value;
                
                // Filter data berdasarkan tahun dan bulan
                let filteredBudget = clinic.budget.monthlyRemaining.filter(item => 
                    item.year.toString() === yearFilter
                );
                
                if (monthFilter !== 'all') {
                    filteredBudget = filteredBudget.filter(item => 
                        item.month.toString() === monthFilter
                    );
                }
                
                // Sort by month
                filteredBudget.sort((a, b) => a.month - b.month);
                
                filteredBudget.forEach((item, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${getMonthName(item.month)}</td>
                        <td>${item.year}</td>
                        <td>Rp ${item.budget.toLocaleString('id-ID')}</td>
                        <td>Rp ${item.spent.toLocaleString('id-ID')}</td>
                        <td>Rp ${item.remaining.toLocaleString('id-ID')}</td>
                        <td>
                            ${currentUser && currentUser.type === 'minkes' ? `
                            <button class="btn-warning edit-budget-btn" data-index="${index}">Edit</button>
                            <button class="btn-danger delete-budget-btn" data-index="${index}">Hapus</button>
                            ` : ''}
                        </td>
                    `;
                    tbody.appendChild(row);
                });
                
                // Setup event listeners untuk tombol edit dan delete
                if (currentUser && currentUser.type === 'minkes') {
                    document.querySelectorAll('.edit-budget-btn').forEach(button => {
                        button.addEventListener('click', function() {
                            const index = parseInt(this.getAttribute('data-index'));
                            editBudgetData(index);
                        });
                    });
                    
                    document.querySelectorAll('.delete-budget-btn').forEach(button => {
                        button.addEventListener('click', function() {
                            const index = parseInt(this.getAttribute('data-index'));
                            deleteBudgetData(index);
                        });
                    });
                }
            }
            
            // Edit data anggaran bulanan
            function editBudgetData(index) {
                if (!currentClinic) return;
                
                // Find the actual index in the original array
                const yearFilter = document.getElementById('budget-year-filter').value;
                const monthFilter = document.getElementById('budget-month-filter').value;
                
                let filteredIndex = 0;
                let actualIndex = -1;
                
                for (let i = 0; i < currentClinic.budget.monthlyRemaining.length; i++) {
                    const item = currentClinic.budget.monthlyRemaining[i];
                    if (item.year.toString() === yearFilter && 
                        (monthFilter === 'all' || item.month.toString() === monthFilter)) {
                        if (filteredIndex === index) {
                            actualIndex = i;
                            break;
                        }
                        filteredIndex++;
                    }
                }
                
                if (actualIndex === -1) return;
                
                const budgetData = currentClinic.budget.monthlyRemaining[actualIndex];
                document.getElementById('budget-month').value = budgetData.month;
                document.getElementById('budget-year').value = budgetData.year;
                document.getElementById('budget-amount').value = budgetData.budget;
                document.getElementById('budget-spent').value = budgetData.spent;
                
                // Tampilkan form
                document.getElementById('budget-form').style.display = 'block';
                document.getElementById('add-budget-btn').style.display = 'none';
                
                // Simpan index untuk update
                currentEditIndex = actualIndex;
            }
            
            // Simpan data anggaran bulanan
            function saveBudgetData() {
                if (!currentClinic) return;
                
                const month = parseInt(document.getElementById('budget-month').value);
                const year = parseInt(document.getElementById('budget-year').value);
                const budget = parseInt(document.getElementById('budget-amount').value);
                const spent = parseInt(document.getElementById('budget-spent').value);
                
                if (isNaN(month) || isNaN(year) || isNaN(budget) || isNaN(spent)) {
                    alert('Mohon isi semua field dengan benar');
                    return;
                }
                
                const remaining = budget - spent;
                
                if (currentEditIndex !== null) {
                    // Update existing data
                    currentClinic.budget.monthlyRemaining[currentEditIndex] = { 
                        month, 
                        year, 
                        budget, 
                        spent, 
                        remaining 
                    };
                    currentEditIndex = null;
                } else {
                    // Add new data
                    // Cek apakah data untuk bulan dan tahun ini sudah ada
                    const existingIndex = currentClinic.budget.monthlyRemaining.findIndex(b => b.month === month && b.year === year);
                    if (existingIndex !== -1) {
                        // Jika sudah ada, update data yang ada
                        currentClinic.budget.monthlyRemaining[existingIndex] = { month, year, budget, spent, remaining };
                    } else {
                        // Jika belum ada, tambahkan data baru
                        currentClinic.budget.monthlyRemaining.push({ month, year, budget, spent, remaining });
                    }
                }
                
                // Sembunyikan form dan tampilkan tombol add
                document.getElementById('budget-form').style.display = 'none';
                document.getElementById('add-budget-btn').style.display = 'inline-block';
                
                // Reset form
                document.getElementById('budget-month').value = '1';
                document.getElementById('budget-year').value = '2024';
                document.getElementById('budget-amount').value = '';
                document.getElementById('budget-spent').value = '';
                
                // Refresh table
                loadClinicBudget(currentClinic);
                
                alert('Data anggaran bulanan berhasil disimpan!');
            }
            
            // Hapus data anggaran bulanan
            function deleteBudgetData(index) {
                if (!currentClinic) return;
                
                // Find the actual index in the original array
                const yearFilter = document.getElementById('budget-year-filter').value;
                const monthFilter = document.getElementById('budget-month-filter').value;
                
                let filteredIndex = 0;
                let actualIndex = -1;
                
                for (let i = 0; i < currentClinic.budget.monthlyRemaining.length; i++) {
                    const item = currentClinic.budget.monthlyRemaining[i];
                    if (item.year.toString() === yearFilter && 
                        (monthFilter === 'all' || item.month.toString() === monthFilter)) {
                        if (filteredIndex === index) {
                            actualIndex = i;
                            break;
                        }
                        filteredIndex++;
                    }
                }
                
                if (actualIndex === -1) return;
                
                if (confirm('Apakah Anda yakin ingin menghapus data anggaran bulanan ini?')) {
                    currentClinic.budget.monthlyRemaining.splice(actualIndex, 1);
                    loadClinicBudget(currentClinic);
                    alert('Data anggaran bulanan berhasil dihapus!');
                }
            }
            
            // Load form edit klinik
            function loadClinicEditForm(clinic) {
                document.getElementById('edit-clinic-id').value = clinic.id;
                document.getElementById('edit-clinic-name').value = clinic.name;
                document.getElementById('edit-clinic-address').value = clinic.address;
                document.getElementById('edit-clinic-phone').value = clinic.phone;
                document.getElementById('edit-clinic-email').value = clinic.email;
                
                // Tampilkan preview gambar
                const imagePreview = document.getElementById('edit-clinic-image-preview');
                if (imagePreview) {
                    imagePreview.src = clinic.image;
                    imagePreview.style.display = 'block';
                }
            }
            
            // Simpan edit klinik
            function saveClinicEdit() {
                if (!currentClinic) return;
                
                const clinicId = parseInt(document.getElementById('edit-clinic-id').value);
                const clinicIndex = clinics.findIndex(c => c.id === clinicId);
                
                if (clinicIndex === -1) return;
                
                // Update data klinik
                clinics[clinicIndex].name = document.getElementById('edit-clinic-name').value;
                clinics[clinicIndex].address = document.getElementById('edit-clinic-address').value;
                clinics[clinicIndex].phone = document.getElementById('edit-clinic-phone').value;
                clinics[clinicIndex].email = document.getElementById('edit-clinic-email').value;
                
                // Update gambar jika ada file baru yang diupload
                const imageInput = document.getElementById('edit-clinic-image');
                if (imageInput.files && imageInput.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        clinics[clinicIndex].image = e.target.result;
                        // Update currentClinic
                        currentClinic.image = e.target.result;
                        
                        // Update gambar di detail klinik
                        const clinicImage = document.getElementById('clinic-image');
                        if (clinicImage) {
                            clinicImage.src = e.target.result;
                        }
                        
                        // Update icon
                        const clinicIcon = document.getElementById('clinic-icon');
                        if (clinicIcon) {
                            clinicIcon.textContent = clinics[clinicIndex].name.charAt(0);
                        }
                        
                        // Tampilkan pesan sukses
                        alert('Data klinik berhasil diperbarui!');
                        
                        // Kembali ke info klinik
                        showClinicInfo();
                    };
                    reader.readAsDataURL(imageInput.files[0]);
                } else {
                    // Jika tidak ada gambar baru, langsung update
                    // Update currentClinic
                    currentClinic.name = clinics[clinicIndex].name;
                    currentClinic.address = clinics[clinicIndex].address;
                    currentClinic.phone = clinics[clinicIndex].phone;
                    currentClinic.email = clinics[clinicIndex].email;
                    
                    // Update icon
                    const clinicIcon = document.getElementById('clinic-icon');
                    if (clinicIcon) {
                        clinicIcon.textContent = clinics[clinicIndex].name.charAt(0);
                    }
                    
                    // Tampilkan pesan sukses
                    alert('Data klinik berhasil diperbarui!');
                    
                    // Kembali ke info klinik
                    showClinicInfo();
                    
                    // Refresh daftar klinik
                    loadClinics();
                }
            }
            
            // Load data rekap
            function loadRecapData() {
                const tbody = document.getElementById('recap-table-body');
                if (!tbody) return;
                
                tbody.innerHTML = '';
                
                const yearFilter = document.getElementById('recap-year-filter').value;
                const monthFilter = document.getElementById('recap-month-filter').value;
                
                clinics.forEach((clinic, index) => {
                    let totalBudget = 0;
                    let totalRealization = 0;
                    
                    if (monthFilter === 'all') {
                        // Sum all months for the year
                        clinic.budget.monthlyRemaining.forEach(item => {
                            if (item.year.toString() === yearFilter) {
                                totalBudget += item.budget;
                                totalRealization += item.spent;
                            }
                        });
                    } else {
                        // Get specific month
                        const budgetData = clinic.budget.monthlyRemaining.find(item => 
                            item.year.toString() === yearFilter && item.month.toString() === monthFilter
                        );
                        
                        if (budgetData) {
                            totalBudget = budgetData.budget;
                            totalRealization = budgetData.spent;
                        }
                    }
                    
                    const remaining = totalBudget - totalRealization;
                    const percentage = totalBudget > 0 ? Math.round((totalRealization / totalBudget) * 100) : 0;
                    
                    const status = percentage < 50 ? 'warning' : percentage < 80 ? 'info' : 'success';
                    const statusText = percentage < 50 ? 'Rendah' : percentage < 80 ? 'Sedang' : 'Tinggi';
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${clinic.name}</td>
                        <td>Rp ${totalBudget.toLocaleString('id-ID')}</td>
                        <td>Rp ${totalRealization.toLocaleString('id-ID')}</td>
                        <td>Rp ${remaining.toLocaleString('id-ID')}</td>
                        <td>${percentage}%</td>
                        <td>
                            <span class="badge badge-${status}">${statusText}</span>
                            <button class="btn-success view-recap-btn" data-id="${clinic.id}" style="margin-top: 10px;">Detail</button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
                
                // Setup event listeners untuk tombol detail
                document.querySelectorAll('.view-recap-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const clinicId = parseInt(this.getAttribute('data-id'));
                        viewClinic(clinicId);
                    });
                });
            }
        </script>
        
        <style>
            .badge {
                display: inline-block;
                padding: 5px 10px;
                border-radius: 20px;
                font-size: 12px;
                font-weight: 500;
                color: white;
            }
            
            .badge-success {
                background-color: #10b981;
            }
            
            .badge-info {
                background-color: #0891b2;
            }
            
            .badge-warning {
                background-color: #f59e0b;
            }
            
            .badge-danger {
                background-color: #dc2626;
            }
        </style>
    </body>
</html>
